(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    141397,       3226]
NotebookOptionsPosition[    137318,       3081]
NotebookOutlinePosition[    137653,       3096]
CellTagsIndexPosition[    137610,       3093]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Liquid crystal director - Full-Tensor form:", "Title",
 CellChangeTimes->{{3.7058500540409107`*^9, 3.70585007060682*^9}, {
  3.706604692497073*^9, 3.706604699918191*^9}}],

Cell[CellGroupData[{

Cell["Object Definitions:", "Section",
 CellChangeTimes->{{3.705850088362289*^9, 3.7058500954482183`*^9}, {
  3.706256754011731*^9, 3.7062567651818438`*^9}}],

Cell[CellGroupData[{

Cell["Definition of Q:", "Subsection",
 CellChangeTimes->{{3.7062592567570677`*^9, 3.706259261508358*^9}}],

Cell["\<\
I am unprotecting \[OpenCurlyDoubleQuote]Plus\[CloseCurlyDoubleQuote] so i \
can write my addition rules to the tensor elements Q[i,j]. Pay attention if \
you want to add/change one of these rules. Playing with protected symbols can \
calse error hard to debug!!\
\>", "Text",
 CellChangeTimes->{{3.706606923806163*^9, 3.706607001316564*^9}, {
   3.706607288508697*^9, 3.706607301633356*^9}, 3.712347724135131*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Unprotect", "[", "Plus", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Plus", "/:", " ", 
     RowBox[{
      RowBox[{"a_", " ", 
       RowBox[{"Q", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], "+", 
      RowBox[{"a_", " ", 
       RowBox[{"Q", "[", 
        RowBox[{"3", ",", "3"}], "]"}]}]}], "=", 
     RowBox[{
      RowBox[{"-", "a"}], " ", 
      RowBox[{"Q", "[", 
       RowBox[{"1", ",", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Plus", "/:", 
     RowBox[{
      RowBox[{"a_", " ", 
       RowBox[{"Q", "[", 
        RowBox[{"1", ",", "1"}], "]"}]}], "+", 
      RowBox[{"a_", " ", 
       RowBox[{"Q", "[", 
        RowBox[{"3", ",", "3"}], "]"}]}]}], "=", 
     RowBox[{
      RowBox[{"-", "a"}], " ", 
      RowBox[{"Q", "[", 
       RowBox[{"2", ",", "2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Plus", "/:", 
     RowBox[{
      RowBox[{"a_", " ", 
       RowBox[{"Q", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], "+", 
      RowBox[{"a_", " ", 
       RowBox[{"Q", "[", 
        RowBox[{"1", ",", "1"}], "]"}]}]}], "=", 
     RowBox[{
      RowBox[{"-", "a"}], " ", 
      RowBox[{"Q", "[", 
       RowBox[{"3", ",", "3"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Plus", "/:", " ", 
     RowBox[{
      RowBox[{"a_", " ", 
       RowBox[{"Q", "[", 
        RowBox[{"2", ",", "2", ",", 
         RowBox[{"x", "[", "i_", "]"}]}], "]"}]}], "+", 
      RowBox[{"a_", " ", 
       RowBox[{"Q", "[", 
        RowBox[{"3", ",", "3", ",", 
         RowBox[{"x", "[", "i_", "]"}]}], "]"}]}]}], "=", 
     RowBox[{
      RowBox[{"-", "a"}], " ", 
      RowBox[{"Q", "[", 
       RowBox[{"1", ",", "1", ",", 
        RowBox[{"x", "[", "i", "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Plus", "/:", " ", 
     RowBox[{
      RowBox[{"a_", " ", 
       RowBox[{"Q", "[", 
        RowBox[{"1", ",", "1", ",", 
         RowBox[{"x", "[", "i_", "]"}]}], "]"}]}], "+", 
      RowBox[{"a_", " ", 
       RowBox[{"Q", "[", 
        RowBox[{"3", ",", "3", ",", 
         RowBox[{"x", "[", "i_", "]"}]}], "]"}]}]}], "=", 
     RowBox[{
      RowBox[{"-", "a"}], " ", 
      RowBox[{"Q", "[", 
       RowBox[{"2", ",", "2", ",", 
        RowBox[{"x", "[", "i", "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Plus", "/:", " ", 
     RowBox[{
      RowBox[{"a_", " ", 
       RowBox[{"Q", "[", 
        RowBox[{"2", ",", "2", ",", 
         RowBox[{"x", "[", "i_", "]"}]}], "]"}]}], "+", 
      RowBox[{"a_", " ", 
       RowBox[{"Q", "[", 
        RowBox[{"1", ",", "1", ",", 
         RowBox[{"x", "[", "i_", "]"}]}], "]"}]}]}], "=", 
     RowBox[{
      RowBox[{"-", "a"}], " ", 
      RowBox[{"Q", "[", 
       RowBox[{"3", ",", "3", ",", 
        RowBox[{"x", "[", "i", "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]",
     "\[IndentingNewLine]", 
    RowBox[{"Plus", "/:", " ", 
     RowBox[{
      RowBox[{"a_", " ", 
       RowBox[{"Q", "[", 
        RowBox[{"2", ",", "2", ",", 
         RowBox[{"x", "[", "i_", "]"}], ",", 
         RowBox[{"x", "[", "j_", "]"}]}], "]"}]}], "+", " ", 
      RowBox[{"a_", " ", 
       RowBox[{"Q", "[", 
        RowBox[{"3", ",", "3", ",", 
         RowBox[{"x", "[", "i_", "]"}], ",", 
         RowBox[{"x", "[", "j_", "]"}]}], "]"}]}]}], "=", 
     RowBox[{
      RowBox[{"-", "a"}], " ", 
      RowBox[{"Q", "[", 
       RowBox[{"1", ",", "1", ",", 
        RowBox[{"x", "[", "i", "]"}], ",", 
        RowBox[{"x", "[", "j", "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Plus", "/:", " ", 
     RowBox[{
      RowBox[{"a_", " ", 
       RowBox[{"Q", "[", 
        RowBox[{"1", ",", "1", ",", 
         RowBox[{"x", "[", "i_", "]"}], ",", 
         RowBox[{"x", "[", "j_", "]"}]}], "]"}]}], "+", " ", 
      RowBox[{"a_", " ", 
       RowBox[{"Q", "[", 
        RowBox[{"3", ",", "3", ",", 
         RowBox[{"x", "[", "i_", "]"}], ",", 
         RowBox[{"x", "[", "j_", "]"}]}], "]"}]}]}], "=", 
     RowBox[{
      RowBox[{"-", "a"}], " ", 
      RowBox[{"Q", "[", 
       RowBox[{"2", ",", "2", ",", 
        RowBox[{"x", "[", "i", "]"}], ",", 
        RowBox[{"x", "[", "j", "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Plus", "/:", " ", 
     RowBox[{
      RowBox[{"a_", " ", 
       RowBox[{"Q", "[", 
        RowBox[{"2", ",", "2", ",", 
         RowBox[{"x", "[", "i_", "]"}], ",", 
         RowBox[{"x", "[", "j_", "]"}]}], "]"}]}], "+", " ", 
      RowBox[{"a_", " ", 
       RowBox[{"Q", "[", 
        RowBox[{"1", ",", "1", ",", 
         RowBox[{"x", "[", "i_", "]"}], ",", 
         RowBox[{"x", "[", "j_", "]"}]}], "]"}]}]}], "=", 
     RowBox[{
      RowBox[{"-", "a"}], " ", 
      RowBox[{"Q", "[", 
       RowBox[{"3", ",", "3", ",", 
        RowBox[{"x", "[", "i", "]"}], ",", 
        RowBox[{"x", "[", "j", "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]",
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Plus", "/:", " ", 
     RowBox[{
      RowBox[{"Q", "[", 
       RowBox[{"2", ",", "2"}], "]"}], "+", " ", 
      RowBox[{"Q", "[", 
       RowBox[{"3", ",", "3"}], "]"}]}], "=", 
     RowBox[{"-", 
      RowBox[{"Q", "[", 
       RowBox[{"1", ",", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Plus", "/:", " ", 
     RowBox[{
      RowBox[{"Q", "[", 
       RowBox[{"1", ",", "1"}], "]"}], "+", " ", 
      RowBox[{"Q", "[", 
       RowBox[{"3", ",", "3"}], "]"}]}], "=", 
     RowBox[{"-", 
      RowBox[{"Q", "[", 
       RowBox[{"2", ",", "2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Plus", "/:", " ", 
     RowBox[{
      RowBox[{"Q", "[", 
       RowBox[{"2", ",", "2"}], "]"}], "+", 
      RowBox[{"Q", "[", 
       RowBox[{"1", ",", "1"}], "]"}]}], "=", 
     RowBox[{"-", " ", 
      RowBox[{"Q", "[", 
       RowBox[{"3", ",", "3"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Plus", "/:", "  ", 
     RowBox[{
      RowBox[{"Q", "[", 
       RowBox[{"2", ",", "2", ",", 
        RowBox[{"x", "[", "i_", "]"}]}], "]"}], "+", 
      RowBox[{"Q", "[", 
       RowBox[{"3", ",", "3", ",", 
        RowBox[{"x", "[", "i_", "]"}]}], "]"}]}], "=", 
     RowBox[{"-", 
      RowBox[{"Q", "[", 
       RowBox[{"1", ",", "1", ",", 
        RowBox[{"x", "[", "i", "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Plus", "/:", "  ", 
     RowBox[{
      RowBox[{"Q", "[", 
       RowBox[{"1", ",", "1", ",", 
        RowBox[{"x", "[", "i_", "]"}]}], "]"}], "+", 
      RowBox[{"Q", "[", 
       RowBox[{"3", ",", "3", ",", 
        RowBox[{"x", "[", "i_", "]"}]}], "]"}]}], "=", 
     RowBox[{"-", 
      RowBox[{"Q", "[", 
       RowBox[{"2", ",", "2", ",", 
        RowBox[{"x", "[", "i", "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Plus", "/:", " ", 
     RowBox[{
      RowBox[{"Q", "[", 
       RowBox[{"2", ",", "2", ",", 
        RowBox[{"x", "[", "i_", "]"}]}], "]"}], "+", " ", 
      RowBox[{"Q", "[", 
       RowBox[{"1", ",", "1", ",", 
        RowBox[{"x", "[", "i_", "]"}]}], "]"}]}], "=", 
     RowBox[{"-", 
      RowBox[{"Q", "[", 
       RowBox[{"3", ",", "3", ",", 
        RowBox[{"x", "[", "i", "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]",
     "\[IndentingNewLine]", 
    RowBox[{"Plus", "/:", " ", 
     RowBox[{
      RowBox[{"Q", "[", 
       RowBox[{"2", ",", "2", ",", 
        RowBox[{"x", "[", "i_", "]"}], ",", 
        RowBox[{"x", "[", "j_", "]"}]}], "]"}], "+", "  ", 
      RowBox[{"Q", "[", 
       RowBox[{"3", ",", "3", ",", 
        RowBox[{"x", "[", "i_", "]"}], ",", 
        RowBox[{"x", "[", "j_", "]"}]}], "]"}]}], "=", 
     RowBox[{"-", 
      RowBox[{"Q", "[", 
       RowBox[{"1", ",", "1", ",", 
        RowBox[{"x", "[", "i", "]"}], ",", 
        RowBox[{"x", "[", "j", "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Plus", "/:", " ", 
     RowBox[{
      RowBox[{"Q", "[", 
       RowBox[{"1", ",", "1", ",", 
        RowBox[{"x", "[", "i_", "]"}], ",", 
        RowBox[{"x", "[", "j_", "]"}]}], "]"}], "+", "  ", 
      RowBox[{"Q", "[", 
       RowBox[{"3", ",", "3", ",", 
        RowBox[{"x", "[", "i_", "]"}], ",", 
        RowBox[{"x", "[", "j_", "]"}]}], "]"}]}], "=", 
     RowBox[{"-", 
      RowBox[{"Q", "[", 
       RowBox[{"2", ",", "2", ",", 
        RowBox[{"x", "[", "i", "]"}], ",", 
        RowBox[{"x", "[", "j", "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Plus", "/:", " ", 
     RowBox[{
      RowBox[{"Q", "[", 
       RowBox[{"2", ",", "2", ",", 
        RowBox[{"x", "[", "i_", "]"}], ",", 
        RowBox[{"x", "[", "j_", "]"}]}], "]"}], "+", " ", 
      RowBox[{"Q", "[", 
       RowBox[{"1", ",", "1", ",", 
        RowBox[{"x", "[", "i_", "]"}], ",", 
        RowBox[{"x", "[", "j_", "]"}]}], "]"}]}], "=", 
     RowBox[{"-", 
      RowBox[{"Q", "[", 
       RowBox[{"3", ",", "3", ",", 
        RowBox[{"x", "[", "i", "]"}], ",", 
        RowBox[{"x", "[", "j", "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Plus", "/:", 
     RowBox[{
      RowBox[{
       RowBox[{"v", "[", "0", "]"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"v", "[", "1", "]"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"v", "[", "2", "]"}], "^", "2"}]}], "=", "1"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "Plus", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.706622423463113*^9, 3.7066224382825537`*^9}, {
  3.710860016442816*^9, 3.710860069673123*^9}, {3.712314750569766*^9, 
  3.7123147591175003`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "operator", " ", "uses", " ", "Q", " ", "as", " ", "an", " ", 
    "implicit", " ", 
    RowBox[{"variable", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DD", "[", 
     RowBox[{"f_", ",", "g_"}], "]"}], ":=", 
    RowBox[{"D", "[", 
     RowBox[{"f", ",", "g", ",", 
      RowBox[{"NonConstants", "\[Rule]", 
       RowBox[{"{", "Q", "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Attention", " ", "here"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q", "/:", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{"i_", ",", "j_"}], "]"}], ",", "k_", ",", 
       RowBox[{"NonConstants", "\[Rule]", 
        RowBox[{"{", "Q", "}"}]}]}], "]"}], ":=", 
     RowBox[{"Q", "[", 
      RowBox[{"i", ",", "j", ",", "k"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q", "/:", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{"i_", ",", "j_"}], "]"}], ",", 
       RowBox[{"Q", "[", 
        RowBox[{"k_", ",", "l_"}], "]"}], ",", 
       RowBox[{"NonConstants", "\[Rule]", 
        RowBox[{"{", "Q", "}"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"i", ",", "k"}], "]"}], "*", 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"j", ",", "l"}], "]"}]}]}], ";"}], " ", "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Q", "/:", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{"i_", ",", "j_"}], "]"}], ",", 
       RowBox[{"Q", "[", 
        RowBox[{"k_", ",", "l_", ",", "m_"}], "]"}], ",", 
       RowBox[{"NonConstants", "\[Rule]", 
        RowBox[{"{", "Q", "}"}]}]}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q", "/:", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{"i_", ",", "j_"}], "]"}], ",", 
       RowBox[{"Q", "[", 
        RowBox[{"k_", ",", "l_", ",", "m_", ",", "n_"}], "]"}], ",", 
       RowBox[{"NonConstants", "\[Rule]", 
        RowBox[{"{", "Q", "}"}]}]}], "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q", "/:", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ",", "l_", ",", 
       RowBox[{"NonConstants", "\[Rule]", 
        RowBox[{"{", "Q", "}"}]}]}], "]"}], ":=", 
     RowBox[{"Q", "[", 
      RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q", "/:", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ",", 
       RowBox[{"Q", "[", 
        RowBox[{"l_", ",", "m_"}], "]"}], ",", 
       RowBox[{"NonConstants", "\[Rule]", 
        RowBox[{"{", "Q", "}"}]}]}], "]"}], ":=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q", "/:", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ",", 
       RowBox[{"Q", "[", 
        RowBox[{"l_", ",", "m_", ",", "n_"}], "]"}], ",", 
       RowBox[{"NonConstants", "\[Rule]", 
        RowBox[{"{", "Q", "}"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"i", ",", "l"}], "]"}], "*", 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"j", ",", "m"}], "]"}], "*", 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"k", ",", "n"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q", "/:", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ",", 
       RowBox[{"Q", "[", 
        RowBox[{"l_", ",", "m_", ",", "n_", ",", "o_"}], "]"}], ",", 
       RowBox[{"NonConstants", "\[Rule]", 
        RowBox[{"{", "Q", "}"}]}]}], "]"}], ":=", "0"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q", "/:", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ",", 
       RowBox[{"Q", "[", 
        RowBox[{"m_", ",", "n_"}], "]"}], ",", 
       RowBox[{"NonConstants", "\[Rule]", 
        RowBox[{"{", "Q", "}"}]}]}], "]"}], ":=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q", "/:", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ",", 
       RowBox[{"Q", "[", 
        RowBox[{"m_", ",", "n_", ",", "o_"}], "]"}], ",", 
       RowBox[{"NonConstants", "\[Rule]", 
        RowBox[{"{", "Q", "}"}]}]}], "]"}], ":=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Q", "/:", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ",", 
       RowBox[{"Q", "[", 
        RowBox[{"m_", ",", "n_", ",", "o_", ",", "p_"}], "]"}], ",", 
       RowBox[{"NonConstants", "\[Rule]", 
        RowBox[{"{", "Q", "}"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"i", ",", "m"}], "]"}], "*", 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"j", ",", "n"}], "]"}], "*", 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"k", ",", "o"}], "]"}], "*", 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"l", ",", "p"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x", "/:", " ", 
     RowBox[{"KroneckerDelta", "[", 
      RowBox[{
       RowBox[{"x", "[", "i_", "]"}], ",", 
       RowBox[{"x", "[", "j_", "]"}]}], "]"}], ":=", 
     RowBox[{"KroneckerDelta", "[", 
      RowBox[{"i", ",", "j"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tcivita", "=", 
     RowBox[{"LeviCivitaTensor", "[", "3", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"civita", "[", 
     RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
    RowBox[{"tcivita", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "1"}], ",", 
       RowBox[{"j", "+", "1"}], ",", 
       RowBox[{"k", "+", "1"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalGamma]", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"i", ",", "k"}], "]"}], "*", 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"j", ",", "l"}], "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"i", ",", "l"}], "]"}], "*", 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"j", ",", "k"}], "]"}]}], "-", 
       RowBox[{
        FractionBox["1", "3"], 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"i", ",", "j"}], "]"}], "*", 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"k", ",", "l"}], "]"}]}]}], ")"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.583676444262723*^9, 3.5836764640521708`*^9}, {
   3.58367652862402*^9, 3.5836767853153143`*^9}, {3.5836768413315773`*^9, 
   3.583676848354002*^9}, 3.583677291237431*^9, {3.5837478860897293`*^9, 
   3.583747889607942*^9}, {3.583747922309927*^9, 3.58374793063903*^9}, {
   3.583747981105968*^9, 3.583748097988385*^9}, {3.583748895084277*^9, 
   3.5837488963449383`*^9}, 3.583748931304633*^9, {3.584086280109206*^9, 
   3.584086282248522*^9}, {3.6240383247139883`*^9, 3.624038378799371*^9}, {
   3.705851178170923*^9, 3.705851191213235*^9}, {3.706256785420949*^9, 
   3.70625679508572*^9}, {3.706256826860588*^9, 3.706256835964931*^9}, {
   3.706256906883834*^9, 3.706256958089905*^9}, {3.7062570323434687`*^9, 
   3.70625705930534*^9}, {3.706257816833889*^9, 3.706257826158923*^9}, {
   3.7062579598219757`*^9, 3.706258051345305*^9}, {3.706258107849494*^9, 
   3.7062581260962954`*^9}, {3.706258182243308*^9, 3.70625818231782*^9}, {
   3.706258609233693*^9, 3.706258628399189*^9}, 3.70625881785*^9, {
   3.706258851967722*^9, 3.70625888631459*^9}, {3.706259023367141*^9, 
   3.706259173159823*^9}, {3.706259218404674*^9, 3.706259266622766*^9}, {
   3.706259301026829*^9, 3.7062593030857973`*^9}, {3.706259472369685*^9, 
   3.706259478969473*^9}, {3.706259546142103*^9, 3.7062596374951468`*^9}, {
   3.706259704701013*^9, 3.706259739036718*^9}, {3.706259821897458*^9, 
   3.7062598271359243`*^9}, {3.706259860164157*^9, 3.7062600757546*^9}, {
   3.706260113135952*^9, 3.706260129662302*^9}, {3.706260164968533*^9, 
   3.706260185548357*^9}, {3.706260230084839*^9, 3.706260288167869*^9}, {
   3.7062619671887407`*^9, 3.70626196750245*^9}, {3.706262013054349*^9, 
   3.706262039930457*^9}, {3.706263039354438*^9, 3.7062630573973846`*^9}, {
   3.706263092028069*^9, 3.706263150427518*^9}, 3.706263190884274*^9, {
   3.706263298925025*^9, 3.706263345894053*^9}, {3.7062635120388393`*^9, 
   3.706263573450691*^9}, {3.7062644206655483`*^9, 3.70626457065333*^9}, {
   3.706266136480268*^9, 3.70626627880882*^9}, {3.7062832425264*^9, 
   3.7062832519320707`*^9}, {3.706283322277193*^9, 3.706283387283023*^9}, {
   3.7062834510775557`*^9, 3.7062835122598133`*^9}, {3.706283591295075*^9, 
   3.706283623089155*^9}, {3.706283746399391*^9, 3.706283755145535*^9}, {
   3.706283791171287*^9, 3.706283863522814*^9}, {3.7062840525052547`*^9, 
   3.7062840959450703`*^9}, {3.706284219535069*^9, 3.706284344492215*^9}, 
   3.70628444168242*^9, {3.706284602447641*^9, 3.706284619488373*^9}, {
   3.706284796161532*^9, 3.706284796779085*^9}, {3.706284830545579*^9, 
   3.70628484591029*^9}, {3.706286776022661*^9, 3.706286784182972*^9}, {
   3.706346606619166*^9, 3.7063466154005957`*^9}, {3.706346651419663*^9, 
   3.706346659701084*^9}, {3.70660579780231*^9, 3.7066058330449944`*^9}, {
   3.7066070070561657`*^9, 3.70660701803894*^9}, {3.706607066062793*^9, 
   3.706607214303883*^9}, {3.70660756130083*^9, 3.706607587865283*^9}, {
   3.706607837839047*^9, 3.706607847009862*^9}, {3.706607933579131*^9, 
   3.7066080634378233`*^9}, {3.7066081110770884`*^9, 
   3.7066081366188097`*^9}, {3.706608345178103*^9, 3.706608441017812*^9}, {
   3.706608692177682*^9, 3.70660877545712*^9}, 3.7066223947993727`*^9, {
   3.712419567693836*^9, 3.712419642036704*^9}, {3.712419773405773*^9, 
   3.71241977577386*^9}, {3.712421834737794*^9, 3.712421839759883*^9}, 
   3.7124220139251003`*^9, {3.7143108925150642`*^9, 3.714310903699871*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"QQ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{"0", ",", "0"}], "]"}], ",", 
       RowBox[{"Q", "[", 
        RowBox[{"0", ",", "1"}], "]"}], ",", 
       RowBox[{"Q", "[", 
        RowBox[{"0", ",", "2"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{"1", ",", "0"}], "]"}], ",", 
       RowBox[{"Q", "[", 
        RowBox[{"1", ",", "1"}], "]"}], ",", 
       RowBox[{"Q", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{"2", ",", "0"}], "]"}], ",", 
       RowBox[{"Q", "[", 
        RowBox[{"2", ",", "1"}], "]"}], ",", 
       RowBox[{"Q", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QQ0", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Q0", "[", 
        RowBox[{"0", ",", "0"}], "]"}], ",", 
       RowBox[{"Q0", "[", 
        RowBox[{"0", ",", "1"}], "]"}], ",", 
       RowBox[{"Q0", "[", 
        RowBox[{"0", ",", "2"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Q0", "[", 
        RowBox[{"0", ",", "1"}], "]"}], ",", 
       RowBox[{"Q0", "[", 
        RowBox[{"1", ",", "1"}], "]"}], ",", 
       RowBox[{"Q0", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Q0", "[", 
        RowBox[{"0", ",", "2"}], "]"}], ",", 
       RowBox[{"Q0", "[", 
        RowBox[{"1", ",", "2"}], "]"}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Q0", "[", 
          RowBox[{"0", ",", "0"}], "]"}]}], "-", 
        RowBox[{"Q0", "[", 
         RowBox[{"1", ",", "1"}], "]"}]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vv", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "2", "]"}], ",", 
     RowBox[{"v", "[", "3", "]"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.709629890543844*^9, 3.709630007583919*^9}, 
   3.7096308974030733`*^9, {3.7108594751645823`*^9, 3.710859500421628*^9}, {
   3.712188202114229*^9, 3.7121882433698997`*^9}, {3.7123070277523127`*^9, 
   3.7123070730592422`*^9}, {3.712316109021709*^9, 3.7123161468306704`*^9}, {
   3.7123477683205853`*^9, 3.7123477688082523`*^9}, {3.712578865352818*^9, 
   3.71257888173372*^9}, {3.712935877166581*^9, 3.7129359615639257`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix definitions:", "Subsection",
 CellChangeTimes->{{3.7062592810484543`*^9, 3.7062592962297583`*^9}, {
  3.706266121752574*^9, 3.70626612464823*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tr", "[", 
    RowBox[{"AA_", "[", 
     RowBox[{"i_", ",", "i_"}], "]"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"AA", "[", 
      RowBox[{"i", ",", "i"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "0", ",", " ", "2"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{3.712314841585558*^9, 3.712315209705174*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bulk Energy:", "Subsection",
 CellChangeTimes->{{3.706259326976788*^9, 3.70625933278335*^9}, {
  3.70962907668456*^9, 3.709629088357386*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fldg", "=", 
    RowBox[{
     RowBox[{
      FractionBox["sigma", "2"], "  ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Q", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "*", 
         RowBox[{"Q", "[", 
          RowBox[{"j", ",", "i"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "0", ",", " ", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", "2"}], "}"}]}], "]"}]}], "+", 
     RowBox[{
      FractionBox["bb", "3"], 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Q", "[", 
          RowBox[{"i", ",", "j"}], "]"}], "*", 
         RowBox[{"Q", "[", 
          RowBox[{"j", ",", "k"}], "]"}], "*", 
         RowBox[{"Q", "[", 
          RowBox[{"k", ",", "i"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "0", ",", " ", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}], "+", 
     "\[IndentingNewLine]", 
     RowBox[{
      FractionBox["cc", "4"], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Q", "[", 
            RowBox[{"i", ",", "j"}], "]"}], "*", 
           RowBox[{"Q", "[", 
            RowBox[{"j", ",", "i"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "0", ",", " ", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "0", ",", "2"}], "}"}]}], "]"}], ")"}], "^", 
       "2"}]}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f1", "=", 
   RowBox[{
    FractionBox["1", "2"], "l1", "*", 
    RowBox[{"Sum", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{"i", ",", "j", ",", 
         RowBox[{"x", "[", "k", "]"}]}], "]"}], "*", 
       RowBox[{"Q", "[", 
        RowBox[{"i", ",", "j", ",", 
         RowBox[{"x", "[", "k", "]"}]}], "]"}]}], "  ", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "0", ",", " ", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2", "=", 
   RowBox[{
    FractionBox["1", "2"], "l2", "*", 
    RowBox[{"Sum", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{"i", ",", "j", ",", 
         RowBox[{"x", "[", "j", "]"}]}], "]"}], "*", 
       RowBox[{"Q", "[", 
        RowBox[{"i", ",", "k", ",", 
         RowBox[{"x", "[", "k", "]"}]}], "]"}]}], " ", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "0", ",", " ", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f3", "=", 
   RowBox[{
    FractionBox["1", "2"], "l3", "*", 
    RowBox[{"Sum", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "*", 
       RowBox[{"Q", "[", 
        RowBox[{"k", ",", "l", ",", 
         RowBox[{"x", "[", "i", "]"}]}], "]"}], "*", 
       RowBox[{"Q", "[", 
        RowBox[{"k", ",", "l", ",", 
         RowBox[{"x", "[", "j", "]"}]}], "]"}]}], " ", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "0", ",", " ", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fs", "=", 
   RowBox[{
    FractionBox["1", "2"], "ls", "*", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{"i", ",", "k", ",", 
         RowBox[{"x", "[", "j", "]"}]}], "]"}], "*", 
       RowBox[{"Q", "[", 
        RowBox[{"i", ",", "j", ",", 
         RowBox[{"x", "[", "k", "]"}]}], "]"}]}], " ", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "0", ",", " ", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fq", "=", 
   RowBox[{"lq", "*", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"civita", "[", 
        RowBox[{"i", ",", "k", ",", "l"}], "]"}], 
       RowBox[{"Q", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "*", 
       RowBox[{"Q", "[", 
        RowBox[{"l", ",", "j", ",", 
         RowBox[{"x", "[", "k", "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "0", ",", " ", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ft", "=", 
   RowBox[{"f1", "+", "f2", "+", "f3", "+", "fq", "+", "fs", "+", "fldg"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7062585082162743`*^9, 3.706258579205392*^9}, {
   3.706258777213492*^9, 3.7062587939313593`*^9}, {3.7062589000659018`*^9, 
   3.706258915977398*^9}, {3.706262815170961*^9, 3.706262850190257*^9}, {
   3.706262907169333*^9, 3.706262907467825*^9}, {3.706263171252501*^9, 
   3.70626317771772*^9}, {3.706263374271489*^9, 3.7062634126440496`*^9}, {
   3.706263784433861*^9, 3.706263790788918*^9}, {3.70626385406112*^9, 
   3.7062639602591963`*^9}, {3.706264042074563*^9, 3.706264107135009*^9}, {
   3.706264137779975*^9, 3.706264175634431*^9}, {3.7062642598932047`*^9, 
   3.706264277696989*^9}, {3.7062643178896103`*^9, 3.706264361700573*^9}, {
   3.706264777554902*^9, 3.706264811252351*^9}, {3.706264979877388*^9, 
   3.7062649881579103`*^9}, {3.706265082672379*^9, 3.706265213410576*^9}, {
   3.7062652565043373`*^9, 3.706265520420775*^9}, {3.706265862740587*^9, 
   3.706265865360722*^9}, {3.7062660077333183`*^9, 3.70626602389719*^9}, {
   3.706267017736965*^9, 3.70626702482198*^9}, {3.7111206739837627`*^9, 
   3.711120684137014*^9}, {3.7123148415964727`*^9, 3.7123148416196823`*^9}, 
   3.712314983289562*^9, {3.712315209719357*^9, 3.712315209738611*^9}, {
   3.712315314683641*^9, 3.7123153543227577`*^9}, {3.7123329395657177`*^9, 
   3.7123329582987633`*^9}, {3.7123477954594183`*^9, 3.7123478703795424`*^9}, 
   3.712348689989333*^9, {3.7124197848682547`*^9, 3.7124198687309217`*^9}, {
   3.712419912943109*^9, 3.712420002534713*^9}, {3.712421850420575*^9, 
   3.7124218536447268`*^9}, {3.712422190471548*^9, 3.7124221911126337`*^9}, 
   3.712478913530919*^9, {3.7126533294850273`*^9, 3.712653373766543*^9}, {
   3.7142937973563433`*^9, 3.714293800394332*^9}, {3.714310546986651*^9, 
   3.714310612440596*^9}, {3.714310646263857*^9, 3.71431064745893*^9}, {
   3.714310972026579*^9, 3.714310972543131*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Surface Energy:", "Subsection",
 CellChangeTimes->{{3.70962910996259*^9, 3.7096291161141768`*^9}}],

Cell[CellGroupData[{

Cell["Rapini-Papoular:", "Subsubsection",
 CellChangeTimes->{{3.7120527777098207`*^9, 3.7120527865959663`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frp", "=", 
   RowBox[{
    FractionBox["1", "2"], "W1", " ", 
    RowBox[{"Tr", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"QQ", "-", "QQ0"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"QQ", "-", "QQ0"}], ")"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7120723910206547`*^9, 3.712072393657921*^9}, {
   3.712186818783019*^9, 3.7121868222854633`*^9}, 3.71218689158528*^9, 
   3.712414567732402*^9, {3.712568389621387*^9, 3.712568389671438*^9}, {
   3.712569020357855*^9, 3.7125690207430687`*^9}, 3.712911585882707*^9, {
   3.7129357317688026`*^9, 3.712935736279009*^9}, {3.7129365931708927`*^9, 
   3.712936593729506*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["E. Wiilmans:", "Subsubsection",
 CellChangeTimes->{{3.712052809538274*^9, 3.712052817299347*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"few", "=", 
    RowBox[{
     RowBox[{"W1", " ", 
      RowBox[{"Tr", "[", 
       RowBox[{"QQ", ".", "QQ"}], "]"}]}], "+", 
     RowBox[{"W2", " ", 
      RowBox[{"(", 
       RowBox[{"vv", ".", "QQ", ".", "vv"}], ")"}]}]}]}], " ", ";"}], 
  RowBox[{"(*", 
   RowBox[{"Taken", " ", "form", " ", "Willman", " ", "thesis"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.7121867882691*^9, 3.7121867937591677`*^9}, {
   3.7129365988140287`*^9, 3.712936598968594*^9}, {3.7129648681033278`*^9, 
   3.712964896572987*^9}, {3.713885228593821*^9, 3.7138852289655933`*^9}, 
   3.71431065715239*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fournier-Galatola:", "Subsubsection",
 CellChangeTimes->{{3.712052839112409*^9, 3.712052882357711*^9}, {
  3.712054114547586*^9, 3.712054133089279*^9}}],

Cell["ref  (doi:10.1209/epl/i2005-10253-5):", "Text",
 CellChangeTimes->{{3.712054124968075*^9, 3.712054128923691*^9}, {
  3.7129116188784647`*^9, 3.712911623052635*^9}}],

Cell["For general boundary conditions:", "Text",
 CellChangeTimes->{{3.7129190091442423`*^9, 3.712919018568592*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Qt", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Q", "[", 
       RowBox[{"i", ",", "j"}], "]"}], "+", 
      FractionBox[
       RowBox[{"Seq", "*", 
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"i", ",", "j"}], "]"}]}], "2"]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"projQ", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "-", 
       RowBox[{
        RowBox[{"v", "[", "i", "]"}], 
        RowBox[{"v", "[", "j", "]"}]}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"projQ", "[", 
      RowBox[{"1", ",", "0"}], "]"}], "=", 
     RowBox[{"projQ", "[", 
      RowBox[{"0", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"projQ", "[", 
      RowBox[{"2", ",", "0"}], "]"}], "=", 
     RowBox[{"projQ", "[", 
      RowBox[{"0", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"projQ", "[", 
      RowBox[{"2", ",", "1"}], "]"}], "=", 
     RowBox[{"projQ", "[", 
      RowBox[{"1", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"projQ", "[", 
      RowBox[{"2", ",", "2"}], "]"}], "=", 
     RowBox[{"2", "-", 
      RowBox[{"projQ", "[", 
       RowBox[{"1", ",", "1"}], "]"}], "-", 
      RowBox[{"projQ", "[", 
       RowBox[{"0", ",", "0"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Qtp", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"projQ", "[", 
         RowBox[{"i", ",", "k"}], "]"}], 
        RowBox[{"Qt", "[", 
         RowBox[{"k", ",", "l"}], "]"}], " ", 
        RowBox[{"projQ", "[", 
         RowBox[{"l", ",", "j"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "0", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ffg", "=", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{
       SubsuperscriptBox["\[Sum]", 
        RowBox[{"i", "=", "0"}], "2"], 
       RowBox[{
        SubsuperscriptBox["\[Sum]", 
         RowBox[{"j", "=", "0"}], "2"], 
        RowBox[{"W1", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Qt", "[", 
             RowBox[{"i", ",", "j"}], "]"}], "-", 
            RowBox[{"Qtp", "[", 
             RowBox[{"i", ",", "j"}], "]"}]}], ")"}], "^", "2"}]}]}]}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"derivedFFG", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
     RowBox[{"W1", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Qt", "[", 
         RowBox[{"i", ",", "j"}], "]"}], "-", 
        RowBox[{"Qtp", "[", 
         RowBox[{"i", ",", "j"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.71205289030263*^9, {3.71205292436764*^9, 3.712052926935638*^9}, {
   3.712052970222941*^9, 3.712053054152747*^9}, {3.712053986614798*^9, 
   3.712054065381518*^9}, 3.712054325589097*^9, 3.712186780581777*^9, 
   3.7129115942215347`*^9, {3.712911625820951*^9, 3.7129116348570213`*^9}, {
   3.7129117194483213`*^9, 3.7129118447251*^9}, {3.712911895521069*^9, 
   3.712911952923704*^9}, {3.712911995793002*^9, 3.712912148865293*^9}, {
   3.712912197784114*^9, 3.7129122706887197`*^9}, {3.712912326770009*^9, 
   3.7129124245547*^9}, {3.7129124938596067`*^9, 3.712912536732133*^9}, {
   3.712912588349432*^9, 3.712912591739222*^9}, 3.7129126654621477`*^9, {
   3.7129126968669367`*^9, 3.7129127025339613`*^9}, 3.712926903413631*^9, 
   3.712928725729376*^9, {3.712932584033272*^9, 3.712932586324885*^9}, {
   3.712933031504736*^9, 3.712933038564076*^9}, {3.712933274111252*^9, 
   3.712933276130878*^9}, {3.712933449679723*^9, 3.712933453865176*^9}, 
   3.712933795812064*^9, {3.712934427046998*^9, 3.712934427429055*^9}, {
   3.7129350086543703`*^9, 3.7129350122282352`*^9}, {3.712935350223927*^9, 
   3.7129353503376513`*^9}, {3.712935477487298*^9, 3.712935477732257*^9}, 
   3.712935750818179*^9, {3.7129366062796783`*^9, 3.712936606684746*^9}, {
   3.7129390516978416`*^9, 3.712939055655719*^9}, {3.7129390959570704`*^9, 
   3.7129390999870872`*^9}, 3.712939145783512*^9, 3.712939313642687*^9, {
   3.712965089805584*^9, 3.712965093380891*^9}, {3.713707851470173*^9, 
   3.713707959989794*^9}, {3.713709155199686*^9, 3.713709245782823*^9}, {
   3.713709894604125*^9, 3.713709899100292*^9}, 3.713710243347542*^9, {
   3.713710449992538*^9, 3.71371045172628*^9}, 3.714224107459136*^9, 
   3.717428208905843*^9, {3.720170749135591*^9, 3.720170751141922*^9}, {
   3.720171033879463*^9, 3.720171187694097*^9}, {3.7201811230865803`*^9, 
   3.7201811889887733`*^9}, 3.720181461859989*^9, {3.720182059350072*^9, 
   3.720182063834399*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculations:", "Chapter",
 CellChangeTimes->{{3.7138906926647987`*^9, 3.713890696586545*^9}}],

Cell[CellGroupData[{

Cell["Use surface potential:", "Section",
 CellChangeTimes->{{3.713890736483099*^9, 3.713890743271142*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fs", "=", "frp"}], ";"}]], "Input",
 CellChangeTimes->{{3.7129366134034243`*^9, 3.712936638901532*^9}, {
   3.713133827634089*^9, 3.7131338280024014`*^9}, {3.7137102631272507`*^9, 
   3.7137102634702578`*^9}, {3.7138855137064466`*^9, 3.7138855140642767`*^9}, 
   3.713890750806094*^9, {3.713897689405163*^9, 3.713897689651279*^9}, {
   3.7142937511382713`*^9, 3.714293751262974*^9}, {3.714382062656592*^9, 
   3.714382062743116*^9}, {3.714403472515974*^9, 3.7144034726440353`*^9}, {
   3.7147239605299463`*^9, 3.71472396064878*^9}, {3.7199352554543247`*^9, 
   3.719935255762834*^9}, {3.7201712732605343`*^9, 3.7201712734539413`*^9}, {
   3.720181526416456*^9, 3.7201815281864853`*^9}}],

Cell[CellGroupData[{

Cell["Simetrize Expression (Use only after manipulations):", "Subsection",
 CellChangeTimes->{{3.706267047248263*^9, 3.70626707383851*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"symmetrizeQ", "[", "f_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"g", "=", "f"}], ",", "h", ",", "i", ",", "j", ",", "k", ",", 
        "l"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", " ", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"h", "=", 
           RowBox[{"g", " ", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Q", "[", 
                RowBox[{"j", ",", "i"}], "]"}], "->", 
               RowBox[{"Q", "[", 
                RowBox[{"i", ",", "j"}], "]"}]}], " ", ",", 
              RowBox[{
               RowBox[{"Q", "[", 
                RowBox[{"j", ",", "i", ",", 
                 RowBox[{"x", "[", "k_", "]"}]}], "]"}], "->", 
               RowBox[{"Q", "[", 
                RowBox[{"i", ",", "j", ",", 
                 RowBox[{"x", "[", "k", "]"}]}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"Q", "[", 
                RowBox[{"j", ",", "i", ",", 
                 RowBox[{"x", "[", "k_", "]"}], ",", 
                 RowBox[{"x", "[", "l_", "]"}]}], "]"}], "->", 
               RowBox[{"Q", "[", 
                RowBox[{"i", ",", "j", ",", 
                 RowBox[{"x", "[", "k", "]"}], ",", 
                 RowBox[{"x", "[", "l", "]"}]}], "]"}]}]}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"g", "=", 
           RowBox[{"h", "/.", 
            RowBox[{
             RowBox[{"Q", "[", 
              RowBox[{"k_", ",", "l_", ",", 
               RowBox[{"x", "[", "j", "]"}], ",", 
               RowBox[{"x", "[", "i", "]"}]}], "]"}], "->", 
             RowBox[{"Q", "[", 
              RowBox[{"k", ",", "l", ",", 
               RowBox[{"x", "[", "i", "]"}], ",", 
               RowBox[{"x", "[", "j", "]"}]}], "]"}]}]}]}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "0", ",", " ", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "i", ",", "3"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"g", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Q", "[", 
            RowBox[{"2", ",", "2"}], "]"}], "\[Rule]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Q", "[", 
              RowBox[{"0", ",", "0"}], "]"}]}], "-", 
            RowBox[{"Q", "[", 
             RowBox[{"1", ",", "1"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"Q", "[", 
            RowBox[{"2", ",", "2", ",", 
             RowBox[{"x", "[", "k_", "]"}]}], "]"}], "\[Rule]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Q", "[", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"x", "[", "k", "]"}]}], "]"}]}], "-", 
            RowBox[{"Q", "[", 
             RowBox[{"1", ",", "1", ",", 
              RowBox[{"x", "[", "k", "]"}]}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"Q", "[", 
            RowBox[{"2", ",", "2", ",", 
             RowBox[{"x", "[", "k_", "]"}], ",", 
             RowBox[{"x", "[", "l_", "]"}]}], "]"}], "\[Rule]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Q", "[", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"x", "[", "k", "]"}], ",", 
               RowBox[{"x", "[", "l", "]"}]}], "]"}]}], "-", 
            RowBox[{"Q", "[", 
             RowBox[{"1", ",", "1", ",", 
              RowBox[{"x", "[", "k", "]"}], ",", 
              RowBox[{"x", "[", "l", "]"}]}], "]"}]}]}]}], "}"}]}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.706267234188753*^9, 3.7062672742621183`*^9}, {
   3.706267339718644*^9, 3.706267351598222*^9}, {3.706267401015416*^9, 
   3.7062676390701303`*^9}, {3.7062676973088093`*^9, 3.706267751326305*^9}, {
   3.706267789859685*^9, 3.706267796960137*^9}, {3.706267871430879*^9, 
   3.706267956567034*^9}, {3.7062680466939507`*^9, 3.706268058352215*^9}, {
   3.706268103470702*^9, 3.706268156855318*^9}, {3.7062681891690407`*^9, 
   3.706268213585108*^9}, {3.706268266340054*^9, 3.706268310141079*^9}, {
   3.706268501436523*^9, 3.706268544034336*^9}, {3.7062685774833813`*^9, 
   3.706268590536193*^9}, {3.706268696828928*^9, 3.706268758391775*^9}, {
   3.706268832215412*^9, 3.706268857973423*^9}, {3.706268937654991*^9, 
   3.7062689381813498`*^9}, {3.706269068104414*^9, 3.7062690700179996`*^9}, {
   3.706269361063884*^9, 3.7062693694234447`*^9}, 3.706269409702774*^9, {
   3.706274882222714*^9, 3.7062748963185368`*^9}, {3.70627494469116*^9, 
   3.7062749450111*^9}, {3.706275008215783*^9, 3.706275042577215*^9}, {
   3.706275148362688*^9, 3.7062751512403793`*^9}, {3.706275246181046*^9, 
   3.706275290115982*^9}, {3.706275323947126*^9, 3.706275413849448*^9}, {
   3.706275486454728*^9, 3.706275526970923*^9}, {3.70627556542031*^9, 
   3.706275629256811*^9}, {3.7062756845523243`*^9, 3.706275689405704*^9}, {
   3.706275730597043*^9, 3.706275803762713*^9}, {3.7066092058298264`*^9, 
   3.706609295947*^9}, {3.706622478254393*^9, 3.706622688875154*^9}, {
   3.706622954079206*^9, 3.706622970594626*^9}, {3.706623158010433*^9, 
   3.706623159294825*^9}, {3.706623271088241*^9, 3.706623272201824*^9}, {
   3.70662356013943*^9, 3.7066235798288593`*^9}, {3.70662367702125*^9, 
   3.7066237091537457`*^9}, {3.706623778847744*^9, 3.706623782788665*^9}, {
   3.706623933934931*^9, 3.706623970811049*^9}, {3.706624210469062*^9, 
   3.706624218156828*^9}, {3.7066242645991087`*^9, 3.706624286402274*^9}, {
   3.706624325137632*^9, 3.706624355722629*^9}, {3.706624395891759*^9, 
   3.7066244001377993`*^9}, {3.706624533336792*^9, 3.706624533618003*^9}, {
   3.7066245687382917`*^9, 3.706624576776739*^9}, 3.712314841627928*^9, 
   3.7123152097459707`*^9, {3.7123162464028*^9, 3.712316285214628*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Templates Rules :", "Section",
 CellChangeTimes->{{3.7105852096198483`*^9, 3.710585212740287*^9}, {
  3.7120531676002817`*^9, 3.712053176128807*^9}}],

Cell["\<\
Here goes rule tempaltes. It does absolutely nothing by itself, but these \
expressions can be used for fast \[OpenCurlyDoubleQuote]copy and paste\
\[CloseCurlyDoubleQuote] when manipulating some results.\
\>", "Text",
 CellChangeTimes->{{3.710585220741514*^9, 3.7105852724887323`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"preRules", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"l2", "\[Rule]", "l2"}], ",", 
       RowBox[{"l3", "\[Rule]", "l3"}], ",", 
       RowBox[{"ls", "\[Rule]", "ls"}], ",", 
       RowBox[{"W1", "\[Rule]", "W1"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"preRules", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"l2", "\[Rule]", "0"}], ",", 
       RowBox[{"l3", "\[Rule]", "0"}], ",", 
       RowBox[{"ls", "\[Rule]", "0"}], ",", 
       RowBox[{"W1", "\[Rule]", "W1"}]}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.710585289628612*^9, 3.7105853300583687`*^9}, {
   3.7120656093904123`*^9, 3.7120656303762693`*^9}, {3.712066292463833*^9, 
   3.712066304821444*^9}, 3.7120664913302402`*^9, {3.7120665825324574`*^9, 
   3.7120665913381147`*^9}, {3.712068375964628*^9, 3.712068385585581*^9}, {
   3.7120695142327547`*^9, 3.712069517160924*^9}, 3.712072089773065*^9, {
   3.712072204717798*^9, 3.712072207626295*^9}, {3.7120730908652782`*^9, 
   3.712073090946342*^9}, {3.712273462386003*^9, 3.712273466045882*^9}, {
   3.712313264050187*^9, 3.712313272016416*^9}, {3.712315725685268*^9, 
   3.712315732932521*^9}, {3.71232396596952*^9, 3.712323966367167*^9}, 
   3.712324052543479*^9, 3.712350570798709*^9, {3.712421672206127*^9, 
   3.7124216759371157`*^9}, 3.712422311212522*^9, {3.712567968721874*^9, 
   3.7125679903977423`*^9}, {3.712569030845621*^9, 3.712569033230054*^9}, {
   3.713710299044251*^9, 3.713710303584404*^9}, {3.7137105221047173`*^9, 
   3.71371052802007*^9}, {3.713711441496028*^9, 3.71371144227896*^9}, 
   3.713715903578965*^9, {3.7137161449511833`*^9, 3.7137161455478373`*^9}, {
   3.7144029065984087`*^9, 3.714402912549437*^9}, {3.7189539118762407`*^9, 
   3.718953966009183*^9}, {3.719934208820417*^9, 3.719934262055048*^9}, {
   3.778246828345142*^9, 3.778246835351447*^9}, {3.778249515594998*^9, 
   3.778249522712727*^9}, {3.7782538117142773`*^9, 3.778253813465972*^9}, {
   3.778254541120358*^9, 3.7782545418057747`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Euler-equations:", "Section",
 CellChangeTimes->{{3.705850118615596*^9, 3.705850123134253*^9}, {
  3.706264579184*^9, 3.7062645853790913`*^9}}],

Cell[CellGroupData[{

Cell["Bulk-Equations:", "Subsection",
 CellChangeTimes->{{3.709626318448627*^9, 3.709626323779973*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"varQ", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"DD", "[", 
     RowBox[{"ft", ",", 
      RowBox[{"Q", "[", 
       RowBox[{"i", ",", "j"}], "]"}]}], "]"}], "-", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"DD", "[", 
       RowBox[{
        RowBox[{"DD", "[", 
         RowBox[{"ft", ",", 
          RowBox[{"Q", "[", 
           RowBox[{"i", ",", "j", ",", 
            RowBox[{"x", "[", "k", "]"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"x", "[", "k", "]"}]}], " ", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bulkBeris", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{"-", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalGamma]", "[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "*", 
       RowBox[{"varQ", "[", 
        RowBox[{"k", ",", "l"}], "]"}]}], " ", ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "0", ",", "2"}], "}"}]}], " ", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.624033624986285*^9, {3.6240336913240232`*^9, 3.624033697542779*^9}, {
   3.624033756953027*^9, 3.624033773454136*^9}, {3.6240381238931293`*^9, 
   3.6240381250479813`*^9}, {3.706264726162415*^9, 3.7062647391323357`*^9}, 
   3.706264774114555*^9, {3.706265588958523*^9, 3.706265755340962*^9}, {
   3.706265819302451*^9, 3.706265826611631*^9}, 3.706266416715831*^9, {
   3.70626657401996*^9, 3.706266574200972*^9}, {3.70626702885306*^9, 
   3.7062670317877407`*^9}, {3.706608805485861*^9, 3.706608821211461*^9}, {
   3.706608856852717*^9, 3.706608856993742*^9}, {3.7066090660703278`*^9, 
   3.706609066173328*^9}, {3.7066095372933598`*^9, 3.706609553051743*^9}, {
   3.706610175968409*^9, 3.70661021594326*^9}, {3.7066107975376883`*^9, 
   3.706610798685349*^9}, {3.706612667385172*^9, 3.706612668644127*^9}, {
   3.706612842099786*^9, 3.706612847280518*^9}, {3.706612890509561*^9, 
   3.7066128905988007`*^9}, {3.706614157972478*^9, 3.7066141814185047`*^9}, {
   3.7066228011845207`*^9, 3.706622803884008*^9}, {3.706623119228491*^9, 
   3.706623122064612*^9}, 3.706623997952771*^9, 3.706624669357376*^9, {
   3.7066247238228073`*^9, 3.7066247265976143`*^9}, {3.706624843344737*^9, 
   3.706624865157658*^9}, {3.710150506935789*^9, 3.710150535697281*^9}, {
   3.710151977246961*^9, 3.710152032538048*^9}, {3.710153713396565*^9, 
   3.710153742727233*^9}, {3.7111255538455143`*^9, 3.7111255638320007`*^9}, 
   3.711201877800611*^9, {3.712313389629657*^9, 3.712313394237117*^9}, {
   3.712315340539554*^9, 3.712315354333289*^9}, {3.712355025463871*^9, 
   3.712355103284987*^9}, {3.7138847580799026`*^9, 3.713884767011463*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Boundary conditions:", "Subsection",
 CellChangeTimes->{{3.709626341047235*^9, 3.709626345757729*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"surfVarQ", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"DD", "[", 
     RowBox[{"fs", ",", 
      RowBox[{"Q", "[", 
       RowBox[{"i", ",", "j"}], "]"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"v", "[", "k", "]"}], "*", 
       RowBox[{"DD", "[", 
        RowBox[{"ft", ",", 
         RowBox[{"Q", "[", 
          RowBox[{"i", ",", "j", ",", 
           RowBox[{"x", "[", "k", "]"}]}], "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"surfBeris", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{"-", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalGamma]", "[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "*", 
       RowBox[{"surfVarQ", "[", 
        RowBox[{"k", ",", "l"}], "]"}]}], " ", ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "0", ",", "2"}], "}"}]}], " ", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fgsurfVarQ", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"derivedFFG", "[", 
     RowBox[{"i", ",", "j"}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"v", "[", "k", "]"}], "*", 
       RowBox[{"DD", "[", 
        RowBox[{"ft", ",", 
         RowBox[{"Q", "[", 
          RowBox[{"i", ",", "j", ",", 
           RowBox[{"x", "[", "k", "]"}]}], "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fgsurfBeris", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{"-", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalGamma]", "[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "*", 
       RowBox[{"fgsurfVarQ", "[", 
        RowBox[{"k", ",", "l"}], "]"}]}], " ", ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "0", ",", "2"}], "}"}]}], " ", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.709626358467476*^9, 3.709626373320581*^9}, {
  3.709627036188848*^9, 3.709627116510837*^9}, {3.7096271727497787`*^9, 
  3.709627191278227*^9}, {3.7096272251875134`*^9, 3.7096272252604628`*^9}, {
  3.709630244962088*^9, 3.709630320526032*^9}, {3.709630450293041*^9, 
  3.709630456266383*^9}, {3.709630955283675*^9, 3.709630984937069*^9}, {
  3.712068212969994*^9, 3.7120682254773207`*^9}, {3.712315340544907*^9, 
  3.7123153543148127`*^9}, {3.720181724154235*^9, 3.720181742484445*^9}, {
  3.720181775536264*^9, 3.720181780381823*^9}, {3.720181976517222*^9, 
  3.720181976689941*^9}}],

Cell[CellGroupData[{

Cell["Export in B. F. Oliveira formalism:", "Subsubsection",
 CellChangeTimes->{{3.7108599407911263`*^9, 3.7108599550586023`*^9}}],

Cell["Rules for converting from expression to text:", "Text",
 CellChangeTimes->{{3.7108608711494513`*^9, 3.710860880617653*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"optimizationRules", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
       "RegularExpression", "[", "\"\<pow\\\\(([QN012_]*),2\\\\)\>\"", "]"}], 
       "\[Rule]", "\"\<($1*$1)\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "RegularExpression", "[", "\"\<pow\\\\(([QN012_]*),3\\\\)\>\"", "]"}], 
       "\[Rule]", "\"\<($1*$1*$1)\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<pow(S_eq_tilde,2)\>\"", "\[Rule]", 
       "\"\<(S_eq_tilde*S_eq_tilde)\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "RegularExpression", "[", "\"\<pow\\\\((v\\\\[[012]\\\\]),2\\\\)\>\"", 
        "]"}], "\[Rule]", "\"\<($1*$1)\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "RegularExpression", "[", "\"\<pow\\\\((v\\\\[[012]\\\\]),3\\\\)\>\"", 
        "]"}], "\[Rule]", "\"\<($1*$1*$1)\>\""}], ",", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{
       "RegularExpression", "[", "\"\<pow\\\\((v\\\\[[012]\\\\]),4\\\\)\>\"", 
        "]"}], "\[Rule]", "\"\<($1*$1*$1*$1)\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "RegularExpression", "[", "\"\<pow\\\\((v\\\\[[012]\\\\]),5\\\\)\>\"", 
        "]"}], "\[Rule]", "\"\<($1*$1*$1*$1*$1)\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "RegularExpression", "[", "\"\<pow\\\\((v\\\\[[012]\\\\]),6\\\\)\>\"", 
        "]"}], "\[Rule]", "\"\<($1*$1*$1*$1*$1*$1)\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "RegularExpression", "[", "\"\<pow\\\\((v\\\\[[012]\\\\]),7\\\\)\>\"", 
        "]"}], "\[Rule]", "\"\<($1*$1*$1*$1*$1*$1*$1)\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "RegularExpression", "[", "\"\<pow\\\\((v\\\\[[012]\\\\]),8\\\\)\>\"", 
        "]"}], "\[Rule]", "\"\<($1*$1*$1*$1*$1*$1*$1*$1)\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "RegularExpression", "[", "\"\<pow\\\\((v\\\\[[012]\\\\]),9\\\\)\>\"", 
        "]"}], "\[Rule]", "\"\<($1*$1*$1*$1*$1*$1*$1*$1*$1)\>\""}]}], "}"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"convertionRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Power(v(0),2)\>\"", "\[Rule]", "\"\<v[0]*v[0]\>\""}], ",", 
     RowBox[{"\"\<Power(v(1),2)\>\"", "\[Rule]", "\"\<v[1]*v[1]\>\""}], ",", 
     RowBox[{"\"\<Power(v(2),2)\>\"", "\[Rule]", "\"\<v[2]*v[2]\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<v(0)\>\"", "\[Rule]", "\"\<v[0]\>\""}], ",", 
     RowBox[{"\"\<v(1)\>\"", "\[Rule]", "\"\<v[1]\>\""}], ",", 
     RowBox[{"\"\<v(2)\>\"", "\[Rule]", "\"\<v[2]\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<aa\>\"", "\[Rule]", "\"\<a\>\""}], ",", 
     RowBox[{"\"\<bb\>\"", "\[Rule]", "\"\<bb\>\""}], ",", 
     RowBox[{"\"\<cc\>\"", "\[Rule]", "\"\<cc\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<l1\>\"", "\[Rule]", "\"\<L1_tilde\>\""}], ",", 
     RowBox[{"\"\<l2\>\"", "\[Rule]", "\"\<L2_tilde\>\""}], ",", 
     RowBox[{"\"\<l3\>\"", "\[Rule]", "\"\<L3_tilde\>\""}], ",", 
     RowBox[{"\"\<lq\>\"", "\[Rule]", "\"\<Lq_tilde\>\""}], ",", 
     RowBox[{"\"\<ls\>\"", "\[Rule]", "\"\<Ls\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<W1\>\"", "\[Rule]", "\"\<Wo1_tilde\>\""}], ",", 
     RowBox[{"\"\<W2\>\"", "\[Rule]", "\"\<Wo2_tilde\>\""}], ",", 
     RowBox[{"\"\<Seq\>\"", "\[Rule]", "\"\<S_eq_tilde\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "RegularExpression", "[", "\"\<Q\\\\(([0123]),([0123])\\\\)\>\"", "]"}],
       "\[Rule]", "\"\<QN$1$2\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "RegularExpression", "[", "\"\<Q0\\\\(([0123]),([0123])\\\\)\>\"", 
       "]"}], "\[Rule]", "\"\<Q0[$1][$2]\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "RegularExpression", "[", 
       "\"\<Q\\\\(([0123]),([0123]),x\\\\(([0123])\\\\)\\\\)\>\"", "]"}], 
      "\[Rule]", "\"\<Q_$1$2_$3\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "RegularExpression", "[", 
       "\"\<Q\\\\(([0123]),([0123]),x\\\\(([0123])\\\\),x\\\\(([0123])\\\\)\\\
\\)\>\"", "]"}], "\[Rule]", "\"\<Q_$1$2_$3$4\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.710860896373931*^9, 3.710860950059881*^9}, {
   3.710861056626267*^9, 3.710861154805443*^9}, {3.710861204216951*^9, 
   3.710861229587133*^9}, {3.7108612684449*^9, 3.710861296370049*^9}, {
   3.7108613920713263`*^9, 3.71086140134869*^9}, {3.710861438340682*^9, 
   3.710861476727038*^9}, 3.7108617907221212`*^9, {3.710861841152046*^9, 
   3.710861876474988*^9}, {3.710861970263062*^9, 3.7108620391147346`*^9}, {
   3.710862120435396*^9, 3.71086227474234*^9}, {3.7108623049597073`*^9, 
   3.7108623938702393`*^9}, {3.7108659765581503`*^9, 3.710865994666439*^9}, {
   3.7108663798344097`*^9, 3.710866380306422*^9}, 3.711120455373631*^9, {
   3.711190425795919*^9, 3.711190427873467*^9}, 3.71119051232165*^9, {
   3.7111907256302643`*^9, 3.711190782575486*^9}, {3.7111908330501966`*^9, 
   3.7111908504355507`*^9}, {3.711190896592145*^9, 3.711190898650646*^9}, {
   3.7111911051137667`*^9, 3.71119114456802*^9}, {3.711199991264431*^9, 
   3.711200042667141*^9}, {3.7112001080633707`*^9, 3.711200122287992*^9}, {
   3.711200184402692*^9, 3.7112001845193644`*^9}, {3.711201408921893*^9, 
   3.711201411673341*^9}, {3.712054190242264*^9, 3.7120542638010893`*^9}, {
   3.7120545110087137`*^9, 3.712054514671537*^9}, {3.7120552832083387`*^9, 
   3.712055312404505*^9}, {3.7120553691965637`*^9, 3.712055373471315*^9}, {
   3.712055411941022*^9, 3.7120554378622847`*^9}, 3.7120555709468412`*^9, {
   3.712065604500867*^9, 3.712065605980932*^9}, {3.712065914443859*^9, 
   3.712065922305915*^9}, {3.712188109484874*^9, 3.712188121790885*^9}, {
   3.712188306396306*^9, 3.712188308989259*^9}, {3.7121885124474707`*^9, 
   3.712188534124091*^9}, {3.7121893290395727`*^9, 3.712189330836505*^9}, {
   3.712315408088995*^9, 3.712315416618309*^9}, {3.712315676967559*^9, 
   3.712315702583673*^9}, {3.7123157656329117`*^9, 3.712315766595714*^9}, {
   3.712315877277635*^9, 3.712315880509654*^9}, {3.7123159114368563`*^9, 
   3.712315920124777*^9}, {3.712316017051982*^9, 3.712316027558607*^9}, {
   3.712324013453512*^9, 3.7123240138501663`*^9}, 3.7123328899456873`*^9, {
   3.712332968149447*^9, 3.712333000813548*^9}, {3.712422292665555*^9, 
   3.712422294222691*^9}, {3.712567998981327*^9, 3.712568013504251*^9}, {
   3.712653933377392*^9, 3.712653940211145*^9}, {3.712670503517952*^9, 
   3.7126705216984673`*^9}, {3.7126722900488043`*^9, 3.712672303115962*^9}, 
   3.7126724215792627`*^9, {3.712672487571248*^9, 3.712672492035945*^9}, {
   3.71267333916558*^9, 3.712673357080743*^9}, {3.712912924726124*^9, 
   3.712913008416748*^9}, {3.712913103984336*^9, 3.712913135736019*^9}, 
   3.712913174108563*^9, {3.7139063928962107`*^9, 3.713906421007128*^9}, {
   3.713906456162664*^9, 3.713906526631898*^9}, {3.713906566653212*^9, 
   3.7139066453257027`*^9}, {3.7139066890940647`*^9, 
   3.7139066933260813`*^9}, {3.7139067412041903`*^9, 3.713906763830763*^9}, {
   3.713906895274576*^9, 3.713906916360674*^9}, {3.714311052649028*^9, 
   3.71431107108189*^9}, {3.714382190922826*^9, 3.7143821969168053`*^9}, {
   3.7144826738186417`*^9, 3.7144827074603*^9}, {3.714730122725458*^9, 
   3.714730204544548*^9}, {3.714730429209331*^9, 3.714730430405884*^9}, {
   3.714730471695655*^9, 3.714730493980261*^9}, {3.7147307558913927`*^9, 
   3.714730799140711*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rapine Papoular Surface:\t", "Subsubsection",
 CellChangeTimes->{{3.712313200271089*^9, 3.712313208037677*^9}, 
   3.712313256310869*^9, {3.72018166653625*^9, 3.720181672846118*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"surface", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<double rp_surface_\>\"", ",", 
     RowBox[{"ToString", "[", "i", "]"}], ",", 
     RowBox[{"ToString", "[", "j", "]"}], ",", 
     "\"\<(const double  QN[5],const double  dQ[15],const double  ddQ[30], \
const double  v[3]) \\n{ \\n return Lambda_s*(\>\"", ",", 
     RowBox[{"StringReplace", "[", 
      RowBox[{
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"CForm", "[", 
           RowBox[{"FullSimplify", "[", 
            RowBox[{
             RowBox[{"symmetrizeQ", "[", 
              RowBox[{"surfBeris", "[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "/.", "preRules"}], 
            "]"}], "]"}], "]"}], ",", "convertionRules"}], "]"}], ",", 
       "optimizationRules"}], "]"}], ",", "\"\<);\\n}\\n\\n\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"StringJoin", "[", 
  RowBox[{
   RowBox[{"surface", "[", 
    RowBox[{"0", ",", "0"}], "]"}], ",", 
   RowBox[{"surface", "[", 
    RowBox[{"0", ",", "1"}], "]"}], ",", 
   RowBox[{"surface", "[", 
    RowBox[{"0", ",", "2"}], "]"}], ",", 
   RowBox[{"surface", "[", 
    RowBox[{"1", ",", "1"}], "]"}], ",", 
   RowBox[{"surface", "[", 
    RowBox[{"1", ",", "2"}], "]"}]}], "]"}], "\[IndentingNewLine]"}], "Input",\

 CellChangeTimes->{{3.7126581614364157`*^9, 3.712658190274213*^9}, 
   3.7126583564267387`*^9, {3.7126598331549187`*^9, 3.71265983513583*^9}, {
   3.7126705383541803`*^9, 3.712670563795512*^9}, {3.7126726942179737`*^9, 
   3.712672706882247*^9}, 3.71742832155532*^9, 3.7199345234356337`*^9, {
   3.719934577522485*^9, 3.7199345798254423`*^9}, {3.7201818046685658`*^9, 
   3.720181805232539*^9}}],

Cell[BoxData["\<\"double rp_surface_00(const double  QN[5],const double  \
dQ[15],const double  ddQ[30], const double  v[3]) \\n{ \\n return \
Lambda_s*(-(Wo1_tilde*QN00) + Wo1_tilde*Q0[0][0] + Lq_tilde*QN02*v[1] - \
Lq_tilde*QN01*v[2] - L1_tilde*(Q_00_0*v[0] + Q_00_1*v[1] + Q_00_2*v[2]));\\n}\
\\n\\ndouble rp_surface_01(const double  QN[5],const double  dQ[15],const \
double  ddQ[30], const double  v[3]) \\n{ \\n return \
Lambda_s*((2*Wo1_tilde*(-QN01 + Q0[0][1]) + Lq_tilde*(-(QN02*v[0]) + \
QN12*v[1] + (QN00 - QN11)*v[2]) - 2*L1_tilde*(Q_01_0*v[0] + Q_01_1*v[1] + \
Q_01_2*v[2]))/2.);\\n}\\n\\ndouble rp_surface_02(const double  QN[5],const \
double  dQ[15],const double  ddQ[30], const double  v[3]) \\n{ \\n return \
Lambda_s*((2*Wo1_tilde*(-QN02 + Q0[0][2]) + Lq_tilde*(QN01*v[0] - (2*QN00 + \
QN11)*v[1] - QN12*v[2]) - 2*L1_tilde*(Q_02_0*v[0] + Q_02_1*v[1] + \
Q_02_2*v[2]))/2.);\\n}\\n\\ndouble rp_surface_11(const double  QN[5],const \
double  dQ[15],const double  ddQ[30], const double  v[3]) \\n{ \\n return \
Lambda_s*(-(Wo1_tilde*QN11) + Wo1_tilde*Q0[1][1] - Lq_tilde*QN12*v[0] + \
Lq_tilde*QN01*v[2] - L1_tilde*(Q_11_0*v[0] + Q_11_1*v[1] + Q_11_2*v[2]));\\n}\
\\n\\ndouble rp_surface_12(const double  QN[5],const double  dQ[15],const \
double  ddQ[30], const double  v[3]) \\n{ \\n return \
Lambda_s*((2*Wo1_tilde*(-QN12 + Q0[1][2]) + Lq_tilde*((QN00 + 2*QN11)*v[0] - \
QN01*v[1] + QN02*v[2]) - 2*L1_tilde*(Q_12_0*v[0] + Q_12_1*v[1] + \
Q_12_2*v[2]))/2.);\\n}\\n\\n\"\>"], "Output",
 CellChangeTimes->{
  3.7199351039619493`*^9, 3.72017125528931*^9, 3.720177531757593*^9, {
   3.720181891391593*^9, 3.720181907473222*^9}, 3.720181989945044*^9, 
   3.720182073478458*^9, 3.720182107321294*^9, 3.777973870027568*^9, 
   3.7779756655821753`*^9, 3.777989570951*^9, 3.7779896374168987`*^9, 
   3.7779896894744368`*^9, 3.777990840308629*^9, 3.7779955919029503`*^9, 
   3.7779957855182467`*^9, 3.777996238808406*^9, 3.778000632457212*^9, 
   3.778230867965467*^9, 3.778231774295281*^9, 3.778246042678627*^9, 
   3.778246301647876*^9, 3.778246572318061*^9, 3.778246884974526*^9, 
   3.778247877867601*^9, 3.7782480826147833`*^9, 3.778248322343046*^9, 
   3.7782495278571053`*^9, 3.778249716294368*^9, 3.77824987798186*^9, 
   3.778250096650618*^9, 3.778250434859989*^9, 3.778250751246272*^9, 
   3.778253819061952*^9, 3.778253979123863*^9, 3.778254546322166*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fg Surface:", "Subsection",
 CellChangeTimes->{{3.720181847490061*^9, 3.720181851755294*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fgsurface", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<double fg_surface_\>\"", ",", 
     RowBox[{"ToString", "[", "i", "]"}], ",", 
     RowBox[{"ToString", "[", "j", "]"}], ",", 
     "\"\<(const double  QN[5],const double  dQ[15],const double  ddQ[30], \
const double  v[3]) \\n{ \\n return Lambda_s*(\>\"", ",", 
     RowBox[{"StringReplace", "[", 
      RowBox[{
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"CForm", "[", 
           RowBox[{"FullSimplify", "[", 
            RowBox[{
             RowBox[{"symmetrizeQ", "[", 
              RowBox[{"fgsurfBeris", "[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "/.", "preRules"}], 
            "]"}], "]"}], "]"}], ",", "convertionRules"}], "]"}], ",", 
       "optimizationRules"}], "]"}], ",", "\"\<);\\n}\\n\\n\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"StringJoin", "[", 
  RowBox[{
   RowBox[{"fgsurface", "[", 
    RowBox[{"0", ",", "0"}], "]"}], ",", 
   RowBox[{"fgsurface", "[", 
    RowBox[{"0", ",", "1"}], "]"}], ",", 
   RowBox[{"fgsurface", "[", 
    RowBox[{"0", ",", "2"}], "]"}], ",", 
   RowBox[{"fgsurface", "[", 
    RowBox[{"1", ",", "1"}], "]"}], ",", 
   RowBox[{"fgsurface", "[", 
    RowBox[{"1", ",", "2"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.720181861166285*^9, 3.720181887071965*^9}, {
  3.720182097160564*^9, 3.720182097323677*^9}}],

Cell[BoxData["\<\"double fg_surface_00(const double  QN[5],const double  \
dQ[15],const double  ddQ[30], const double  v[3]) \\n{ \\n return \
Lambda_s*((-6*L1_tilde*Q_00_0*v[0] + Wo1_tilde*(S_eq_tilde - 2*(QN00 + QN11) \
- 4*(S_eq_tilde + 2*QN00)*v[0]*v[0] + (S_eq_tilde + 6*QN00 + \
2*QN11)*(v[0]*v[0]*v[0]*v[0])) + 6*Lq_tilde*QN02*v[1] + \
v[1]*(-6*L1_tilde*Q_00_1 + Wo1_tilde*(2*(S_eq_tilde + 2*QN11)*v[1] + \
(-S_eq_tilde + 2*QN00 + 8*QN11)*v[0]*v[0]*v[1] + 2*(-S_eq_tilde + \
QN00)*(v[1]*v[1]*v[1]) + 4*QN01*v[0]*(-1 + 2*v[0]*v[0] - v[1]*v[1]))) + \
2*(-3*Lq_tilde*QN01 - 3*L1_tilde*Q_00_2 + 2*Wo1_tilde*(QN02*v[0]*(-2 + \
3*v[0]*v[0]) + QN12*(1 + 3*v[0]*v[0])*v[1]))*v[2] + Wo1_tilde*((S_eq_tilde - \
6*QN00 - 4*QN11)*v[0]*v[0] - 4*QN01*v[0]*v[1] + 2*(-S_eq_tilde + \
QN00)*v[1]*v[1])*v[2]*v[2])/6.);\\n}\\n\\ndouble fg_surface_01(const double  \
QN[5],const double  dQ[15],const double  ddQ[30], const double  v[3]) \\n{ \
\\n return Lambda_s*((-2*L1_tilde*Q_01_0*v[0] - v[0]*(Lq_tilde*QN02 + \
2*Wo1_tilde*QN01*v[0]) + Lq_tilde*QN12*v[1] + v[1]*(-2*L1_tilde*Q_01_1 + \
Wo1_tilde*(-2*(S_eq_tilde + QN00 + QN11)*v[0] + (S_eq_tilde + \
2*QN00)*(v[0]*v[0]*v[0]) + 2*QN01*(-1 + 2*v[0]*v[0])*v[1] + (S_eq_tilde + \
2*QN11)*v[0]*v[1]*v[1])) + (Lq_tilde*(QN00 - QN11) - 2*L1_tilde*Q_01_2 + \
2*Wo1_tilde*(QN02*(-1 + 2*v[0]*v[0])*v[1] + QN12*v[0]*(-1 + \
2*v[1]*v[1])))*v[2] + Wo1_tilde*(S_eq_tilde - 2*(QN00 + \
QN11))*v[0]*v[1]*v[2]*v[2])/2.);\\n}\\n\\ndouble fg_surface_02(const double  \
QN[5],const double  dQ[15],const double  ddQ[30], const double  v[3]) \\n{ \
\\n return Lambda_s*((-2*Wo1_tilde*QN02 + Lq_tilde*QN01*v[0] - \
2*L1_tilde*Q_02_0*v[0] - Lq_tilde*(2*QN00 + QN11)*v[1] - \
2*L1_tilde*Q_02_1*v[1] - 2*Wo1_tilde*(QN02*(-1 + v[0]*v[0]) + \
QN12*v[0]*v[1])*(v[0]*v[0] + v[1]*v[1]) - (Lq_tilde*QN12 + 2*L1_tilde*Q_02_2 \
+ Wo1_tilde*(2*QN01*v[1] + v[0]*(S_eq_tilde - 2*(2*QN01*v[0]*v[1] + QN00*(-1 \
+ 2*v[0]*v[0] + v[1]*v[1]) + QN11*(v[0]*v[0] + 2*v[1]*v[1])))))*v[2] + \
2*Wo1_tilde*v[0]*(QN02*v[0] + QN12*v[1])*v[2]*v[2])/2.);\\n}\\n\\ndouble \
fg_surface_11(const double  QN[5],const double  dQ[15],const double  ddQ[30], \
const double  v[3]) \\n{ \\n return Lambda_s*((-6*Lq_tilde*QN12*v[0] - \
6*L1_tilde*Q_11_0*v[0] + Wo1_tilde*(S_eq_tilde - 2*(QN00 + QN11) + \
2*(S_eq_tilde + 2*QN00)*v[0]*v[0] + 2*(-S_eq_tilde + \
QN11)*(v[0]*v[0]*v[0]*v[0])) + v[1]*(-6*L1_tilde*Q_11_1 + \
Wo1_tilde*(-4*(S_eq_tilde + 2*QN11)*v[1] + (-S_eq_tilde + 8*QN00 + \
2*QN11)*v[0]*v[0]*v[1] + (S_eq_tilde + 2*QN00 + 6*QN11)*(v[1]*v[1]*v[1]) - \
4*QN01*v[0]*(1 + v[0]*v[0] - 2*v[1]*v[1]))) + 2*(3*Lq_tilde*QN01 - \
3*L1_tilde*Q_11_2 + 2*Wo1_tilde*(QN12*v[1]*(-2 + 3*v[1]*v[1]) + QN02*v[0]*(1 \
+ 3*v[1]*v[1])))*v[2] + Wo1_tilde*(2*(-S_eq_tilde + QN11)*v[0]*v[0] - \
4*QN01*v[0]*v[1] + (S_eq_tilde - 4*QN00 - \
6*QN11)*v[1]*v[1])*v[2]*v[2])/6.);\\n}\\n\\ndouble fg_surface_12(const double \
 QN[5],const double  dQ[15],const double  ddQ[30], const double  v[3]) \\n{ \
\\n return Lambda_s*((-2*Wo1_tilde*QN12 + Lq_tilde*(QN00 + 2*QN11)*v[0] - \
2*L1_tilde*Q_12_0*v[0] - Lq_tilde*QN01*v[1] - 2*L1_tilde*Q_12_1*v[1] - \
2*Wo1_tilde*(v[0]*v[0] + v[1]*v[1])*(QN02*v[0]*v[1] + QN12*(-1 + v[1]*v[1])) \
+ (Lq_tilde*QN02 - 2*L1_tilde*Q_12_2 + Wo1_tilde*(2*QN01*v[0]*(-1 + \
2*v[1]*v[1]) + v[1]*(-S_eq_tilde + 2*(QN00*(2*v[0]*v[0] + v[1]*v[1]) + \
QN11*(-1 + v[0]*v[0] + 2*v[1]*v[1])))))*v[2] + 2*Wo1_tilde*v[1]*(QN02*v[0] + \
QN12*v[1])*v[2]*v[2])/2.);\\n}\\n\\n\"\>"], "Output",
 CellChangeTimes->{{3.72018189269666*^9, 3.720181907607712*^9}, 
   3.720181997199821*^9, 3.720182086593916*^9, 3.72018212586598*^9, 
   3.7779738790791397`*^9, 3.7779756758758297`*^9, 3.7779895812087173`*^9, 
   3.777989648443787*^9, 3.777989701006674*^9, 3.777990852676056*^9, 
   3.777995603793275*^9, 3.777995798439581*^9, 3.777996248588187*^9, 
   3.778000661266292*^9, 3.778230876959236*^9, 3.778231783480528*^9, 
   3.778246051218487*^9, 3.778246311331658*^9, 3.7782465810030937`*^9, 
   3.778246896978669*^9, 3.77824788679757*^9, 3.778248091564056*^9, 
   3.77824833126824*^9, 3.778249536679883*^9, 3.778249726091363*^9, 
   3.778249888344761*^9, 3.7782501072990303`*^9, 3.778250443532338*^9, 
   3.778250760676152*^9, 3.778253827700594*^9, 3.778253987691074*^9, 
   3.77825455710544*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bulk", "Subsubsection",
 CellChangeTimes->{{3.712313303530979*^9, 3.7123133042153378`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"bulk", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<double bulk_\>\"", ",", 
     RowBox[{"ToString", "[", "i", "]"}], ",", 
     RowBox[{"ToString", "[", "j", "]"}], ",", 
     "\"\<(const double  QN[5],const double  dQ[15],const double  ddQ[30]) \
\\n{ \\n return Lambda*(\>\"", ",", 
     RowBox[{"StringReplace", "[", 
      RowBox[{
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"CForm", "[", 
           RowBox[{"FullSimplify", "[", 
            RowBox[{
             RowBox[{"symmetrizeQ", "[", 
              RowBox[{"bulkBeris", "[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "/.", "preRules"}], 
            "]"}], "]"}], "]"}], ",", "convertionRules"}], "]"}], ",", 
       "optimizationRules"}], "]"}], ",", "\"\<);\\n}\\n\\n\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"StringJoin", "[", 
  RowBox[{
   RowBox[{"bulk", "[", 
    RowBox[{"0", ",", "0"}], "]"}], ",", 
   RowBox[{"bulk", "[", 
    RowBox[{"0", ",", "1"}], "]"}], ",", 
   RowBox[{"bulk", "[", 
    RowBox[{"0", ",", "2"}], "]"}], ",", 
   RowBox[{"bulk", "[", 
    RowBox[{"1", ",", "1"}], "]"}], ",", 
   RowBox[{"bulk", "[", 
    RowBox[{"1", ",", "2"}], "]"}]}], "]"}], "\[IndentingNewLine]"}], "Input",\

 CellChangeTimes->{{3.712658259092368*^9, 3.712658320287767*^9}, 
   3.712658351421117*^9, {3.712659841439673*^9, 3.7126598432016573`*^9}, {
   3.712672206461144*^9, 3.712672232049819*^9}, {3.7126726363402977`*^9, 
   3.7126726715801067`*^9}, {3.717428341316432*^9, 3.717428345693162*^9}, 
   3.7199345679548883`*^9}],

Cell[BoxData["\<\"double bulk_00(const double  QN[5],const double  \
dQ[15],const double  ddQ[30]) \\n{ \\n return Lambda*((-3*sigma*QN00 - \
6*cc*QN00*((QN00*QN00) + (QN01*QN01) + (QN02*QN02) + QN00*QN11 + (QN11*QN11) \
+ (QN12*QN12)) - bb*((QN00*QN00) + (QN01*QN01) + (QN02*QN02) - 2*QN00*QN11 - \
2*((QN11*QN11) + (QN12*QN12))) + 6*Lq_tilde*(Q_01_2 - Q_02_1) + \
3*L1_tilde*(Q_00_00 + Q_00_11 + Q_00_22))/3.);\\n}\\n\\ndouble bulk_01(const \
double  QN[5],const double  dQ[15],const double  ddQ[30]) \\n{ \\n return \
Lambda*(-(QN01*(sigma + bb*(QN00 + QN11) + 2*cc*((QN00*QN00) + (QN01*QN01) + \
(QN02*QN02) + QN00*QN11 + (QN11*QN11)))) - bb*QN02*QN12 - \
2*cc*QN01*(QN12*QN12) + Lq_tilde*(-Q_00_2 + Q_02_0 + Q_11_2 - Q_12_1) + \
L1_tilde*(Q_01_00 + Q_01_11 + Q_01_22));\\n}\\n\\ndouble bulk_02(const double \
 QN[5],const double  dQ[15],const double  ddQ[30]) \\n{ \\n return \
Lambda*(-(sigma*QN02) + bb*(QN02*QN11 - QN01*QN12) - 2*cc*QN02*((QN00*QN00) + \
(QN01*QN01) + (QN02*QN02) + QN00*QN11 + (QN11*QN11) + (QN12*QN12)) + \
Lq_tilde*(2*Q_00_1 - Q_01_0 + Q_11_1 + Q_12_2) + L1_tilde*(Q_02_00 + Q_02_11 \
+ Q_02_22));\\n}\\n\\ndouble bulk_11(const double  QN[5],const double  \
dQ[15],const double  ddQ[30]) \\n{ \\n return Lambda*((bb*(2*(QN00*QN00) - \
(QN01*QN01) + 2*(QN02*QN02) + 2*QN00*QN11 - (QN11*QN11) - (QN12*QN12)) - \
3*QN11*(sigma + 2*cc*((QN00*QN00) + (QN01*QN01) + (QN02*QN02) + QN00*QN11 + \
(QN11*QN11) + (QN12*QN12))) - 6*Lq_tilde*Q_01_2 + 6*Lq_tilde*Q_12_0 + \
3*L1_tilde*(Q_11_00 + Q_11_11 + Q_11_22))/3.);\\n}\\n\\ndouble bulk_12(const \
double  QN[5],const double  dQ[15],const double  ddQ[30]) \\n{ \\n return \
Lambda*(bb*(-(QN01*QN02) + QN00*QN12) - QN12*(sigma + 2*cc*((QN00*QN00) + \
(QN01*QN01) + (QN02*QN02) + QN00*QN11 + (QN11*QN11) + (QN12*QN12))) - \
Lq_tilde*(Q_00_0 - Q_01_1 + Q_02_2 + 2*Q_11_0) + L1_tilde*(Q_12_00 + Q_12_11 \
+ Q_12_22));\\n}\\n\\n\"\>"], "Output",
 CellChangeTimes->{
  3.712913201565599*^9, 3.712928768604219*^9, 3.7129298589210987`*^9, 
   3.712932614252495*^9, 3.712933085190968*^9, 3.7129333579195642`*^9, 
   3.712933916213605*^9, 3.712935783082777*^9, 3.712935996037166*^9, 
   3.712936356552156*^9, 3.712936671875536*^9, 3.712939498002625*^9, 
   3.71296495758206*^9, 3.7131338519409523`*^9, 3.7136294255969048`*^9, 
   3.713709347687612*^9, 3.713710489376019*^9, 3.713710557821897*^9, 
   3.713711472113736*^9, 3.713715932645917*^9, 3.713716177095056*^9, 
   3.713884447319374*^9, 3.713885539611209*^9, 3.7138977174754553`*^9, 
   3.7139059361869507`*^9, 3.7139060196176777`*^9, 3.7139065532018642`*^9, 
   3.7139066733394623`*^9, 3.713906720933673*^9, 3.713906782619731*^9, 
   3.71390681488246*^9, 3.713906943887178*^9, 3.7139140600596943`*^9, 
   3.7142937726059923`*^9, 3.714310650725338*^9, 3.7143110127508802`*^9, 
   3.7143111002754793`*^9, 3.71438208641821*^9, 3.714382224565773*^9, 
   3.71440314362783*^9, 3.714403568838155*^9, 3.714482295845873*^9, 
   3.71448271204806*^9, 3.7144827442626743`*^9, 3.7147241903083477`*^9, 
   3.714730739972268*^9, 3.7147310857293053`*^9, 3.71742856190137*^9, 
   3.719934531285878*^9, 3.719934574255516*^9, 3.719935108430484*^9, 
   3.720171258814996*^9, 3.720177538770823*^9, {3.720181900133684*^9, 
   3.720181910849029*^9}, 3.720182000833559*^9, 3.720182090282174*^9, 
   3.72018212960457*^9, 3.777973881066547*^9, 3.7779756778469543`*^9, 
   3.777989583400931*^9, 3.777989650514883*^9, 3.777989703177248*^9, 
   3.777990854896171*^9, 3.777995606119507*^9, 3.777995800627408*^9, 
   3.77799625076497*^9, 3.778000663830517*^9, 3.7782308789578257`*^9, 
   3.778231785511277*^9, 3.778246053074129*^9, 3.778246313189301*^9, 
   3.7782465829140463`*^9, 3.778247915390173*^9, 3.778248119979361*^9, 
   3.778248359694007*^9, 3.778249538566787*^9, 3.778249727985865*^9, 
   3.778249890249638*^9, 3.778250109214089*^9, 3.7782504454024897`*^9, 
   3.778250762544297*^9, 3.7782538291233187`*^9, 3.778253989061339*^9, 
   3.778254559094419*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["For use in my tester program", "Chapter",
 CellChangeTimes->{{3.712350306680221*^9, 3.712350308776287*^9}}],

Cell[CellGroupData[{

Cell["Auxiliary function:", "Section",
 CellChangeTimes->{{3.712351058478099*^9, 3.7123510673978033`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pointerChoser", "[", 
     RowBox[{"k_", ",", "l_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"first", "=", "k"}], ",", 
        RowBox[{"second", "=", "l"}], ",", "i", ",", "j"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"i", "=", 
        RowBox[{"ToString", "[", "first", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"j", "=", 
        RowBox[{"ToString", "[", "second", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "<>", "j"}], "\[Equal]", "\"\<00\>\""}], ",", 
         "\"\<0\>\"", ",", 
         RowBox[{
          RowBox[{"i", "<>", "j"}], "\[Equal]", "\"\<01\>\""}], ",", 
         "\"\<1\>\"", ",", 
         RowBox[{
          RowBox[{"i", "<>", "j"}], "\[Equal]", "\"\<02\>\""}], ",", 
         "\"\<2\>\"", ",", 
         RowBox[{
          RowBox[{"i", "<>", "j"}], "\[Equal]", "\"\<11\>\""}], ",", 
         "\"\<3\>\"", ",", 
         RowBox[{
          RowBox[{"i", "<>", "j"}], "\[Equal]", "\"\<12\>\""}], ",", 
         "\"\<4\>\"", ",", "True", ",", "\"\<None\>\""}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"StrPointerChoser", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"i", "<>", "j"}], "\[Equal]", "\"\<00\>\""}], ",", 
       "\"\<0\>\"", ",", 
       RowBox[{
        RowBox[{"i", "<>", "j"}], "\[Equal]", "\"\<01\>\""}], ",", 
       "\"\<1\>\"", ",", 
       RowBox[{
        RowBox[{"i", "<>", "j"}], "\[Equal]", "\"\<02\>\""}], ",", 
       "\"\<2\>\"", ",", 
       RowBox[{
        RowBox[{"i", "<>", "j"}], "\[Equal]", "\"\<11\>\""}], ",", 
       "\"\<3\>\"", ",", 
       RowBox[{
        RowBox[{"i", "<>", "j"}], "\[Equal]", "\"\<12\>\""}], ",", 
       "\"\<4\>\"", ",", "True", ",", "\"\<None\>\""}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StrPointerChoser", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"Print", "[", 
   RowBox[{"\"\<\\n\>\"", "<>", "i", "<>", "j", "<>", "\"\<\\n\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"postionCreator", "[", 
     RowBox[{"m_", ",", "n_", ",", "i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
    
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sm", ",", "sn", ",", "si", ",", "sj", ",", "sk"}], "}"}], ",",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sm", "=", 
        RowBox[{"ToString", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sn", "=", 
        RowBox[{"ToString", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"si", "=", 
        RowBox[{"ToString", "[", "i", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sj", "=", 
        RowBox[{"ToString", "[", "j", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sk", "=", 
        RowBox[{"ToString", "[", "k", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "\"\<5*(Nx*(Ny*\>\"", "<>", "sk", "<>", "\"\<+\>\"", "<>", "sj", "<>", 
        "\"\<)+\>\"", "<>", "si", "<>", "\"\<)+\>\"", "<>", 
        RowBox[{"pointerChoser", "[", 
         RowBox[{"m", ",", "n"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StrPositionCreator", "[", 
   RowBox[{"m_", ",", "n_", ",", "i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{
  "\"\<5*(Nx*(Ny*\>\"", "<>", "k", "<>", "\"\<+\>\"", "<>", "j", "<>", 
   "\"\<)+\>\"", "<>", "i", "<>", "\"\<)+\>\"", "<>", 
   RowBox[{"pointerChoser", "[", 
    RowBox[{"m", ",", "n"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.7123511660483932`*^9, 3.712351166775279*^9}, {
  3.712351199788241*^9, 3.712351306867296*^9}, {3.7123514206596413`*^9, 
  3.712351424759802*^9}, {3.712355178686057*^9, 3.712355191931387*^9}, {
  3.777973517942081*^9, 3.777973546756522*^9}, {3.777974411365307*^9, 
  3.777974568703033*^9}, {3.777974831522361*^9, 3.7779748316560497`*^9}, {
  3.777989207096044*^9, 3.777989237605023*^9}, {3.777989983121722*^9, 
  3.777990036739217*^9}, {3.7779901520258703`*^9, 3.777990206539117*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Surface", "Section",
 CellChangeTimes->{{3.712351528183597*^9, 3.712351529146723*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Clear", "[", "surface", "]"}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"surface", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<f[\>\"", ",", 
       RowBox[{"pointerChoser", "[", 
        RowBox[{"i", ",", "j"}], "]"}], ",", 
       "\"\<*NN+(k*Ny+j)*Nx+i]=Lambda*(\>\"", ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"CForm", "[", 
           RowBox[{"FullSimplify", "[", 
            RowBox[{
             RowBox[{"symmetrizeQ", "[", 
              RowBox[{"surfBeris", "[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "/.", "preRules"}], 
            "]"}], "]"}], "]"}], ",", "convertionRules"}], "]"}], ",", 
       "\"\<);\\n\\n\>\""}], "]"}], "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"surface", "[", 
        RowBox[{"0", ",", "0"}], "]"}], ",", 
       RowBox[{"surface", "[", 
        RowBox[{"0", ",", "1"}], "]"}], ",", 
       RowBox[{"surface", "[", 
        RowBox[{"0", ",", "2"}], "]"}], ",", 
       RowBox[{"surface", "[", 
        RowBox[{"1", ",", "1"}], "]"}], ",", 
       RowBox[{"surface", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], "]"}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7123254299830303`*^9, 3.712325458443598*^9}, {
   3.712325580186624*^9, 3.7123256254848557`*^9}, {3.712325667993423*^9, 
   3.712325777343752*^9}, {3.712325830749795*^9, 3.712325831015523*^9}, {
   3.712325872153763*^9, 3.71232587802075*^9}, {3.712325937706277*^9, 
   3.7123259731539917`*^9}, {3.7123261530881968`*^9, 3.712326155381219*^9}, {
   3.712326265731724*^9, 3.712326266017448*^9}, 3.712326296062354*^9, {
   3.712326328936161*^9, 3.712326358256283*^9}, 3.7123266502813673`*^9, {
   3.712349813686822*^9, 3.712349814413925*^9}, {3.712351038272168*^9, 
   3.7123510413496027`*^9}, {3.7123511117340918`*^9, 3.712351140215469*^9}, {
   3.71235117619864*^9, 3.7123511789661407`*^9}, {3.712351382157813*^9, 
   3.71235139785562*^9}, 3.71371021474334*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bulk", "Section",
 CellChangeTimes->{{3.712351538221492*^9, 3.7123515401340437`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7123266329402122`*^9, 3.712326720841094*^9}, {
   3.712348760416688*^9, 3.71234876465357*^9}, {3.7123513505921288`*^9, 
   3.712351356507416*^9}, {3.712351461918298*^9, 3.712351464992556*^9}, 
   3.713710207795989*^9, {3.777973759373519*^9, 3.777973759525605*^9}, 
   3.777973796815507*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Jacobian", "Chapter",
 CellChangeTimes->{{3.7123515709793367`*^9, 3.712351573629282*^9}}],

Cell[CellGroupData[{

Cell["Auxiliary Routines:", "Section",
 CellChangeTimes->{{3.712399832124959*^9, 3.712399838397648*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"jacRules", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
       "RegularExpression", "[", "\"\<Power\\\\(([dxyz1]*),2\\\\)\>\"", "]"}],
        "\[Rule]", "\"\<($1*$1)\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "RegularExpression", "[", 
        "\"\<Power\\\\((Q\\\\([012],[012],[ipm1]*,[jpm1]*,[kmp1]*\\\\)),2\\\\)\
\>\"", "]"}], "\[Rule]", "\"\<($1*$1)\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<v(2)\>\"", "\[Rule]", "\"\<v[2]\>\""}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.712353548437791*^9, 3.712353571527253*^9}, {
   3.712399852151273*^9, 3.71239985232441*^9}, {3.712401271239066*^9, 
   3.712401286640148*^9}, 3.77797351366678*^9, {3.77798943022925*^9, 
   3.777989437612952*^9}, {3.777989495613927*^9, 3.777989516772451*^9}, {
   3.777995977406468*^9, 3.777995979886526*^9}, {3.777997506302985*^9, 
   3.777997568355287*^9}, {3.7779976376877728`*^9, 3.777997688176643*^9}, {
   3.778000136454502*^9, 3.778000226284009*^9}, {3.778000400626471*^9, 
   3.778000412095297*^9}, {3.778000715538512*^9, 3.7780007201701107`*^9}, {
   3.778249871202713*^9, 3.778249873825758*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bulk", "Section",
 CellChangeTimes->{{3.7123998650684023`*^9, 3.712399865862987*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"jacExpand", "[", "f_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"expresion", "=", "f"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r1", "=", 
         RowBox[{"expresion", "/.", 
          RowBox[{
           RowBox[{"Q", "[", 
            RowBox[{"m_", ",", "n_"}], "]"}], "\[Rule]", 
           RowBox[{"Q", "[", 
            RowBox[{"m", ",", "n", ",", "i", ",", "j", ",", "k"}], 
            "]"}]}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"r3", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"r1", " ", "/.", " ", 
            RowBox[{
             RowBox[{"Q", "[", 
              RowBox[{"m_", ",", "n_", ",", 
               RowBox[{"x", "[", "0", "]"}]}], "]"}], "\[Rule]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Q", "[", 
                 RowBox[{"m", ",", "n", ",", "ip1", ",", "j", ",", "k"}], 
                 "]"}], "-", 
                RowBox[{"Q", "[", 
                 RowBox[{"m", ",", "n", ",", "im1", ",", "j", ",", "k"}], 
                 "]"}]}], ")"}], "*", 
              RowBox[{"dx1", "/", "2"}]}]}]}], "\[IndentingNewLine]", "/.", 
           RowBox[{
            RowBox[{"Q", "[", 
             RowBox[{"m_", ",", "n_", ",", 
              RowBox[{"x", "[", "1", "]"}]}], "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Q", "[", 
                RowBox[{"m", ",", "n", ",", "i", ",", "jp1", ",", "k"}], 
                "]"}], "-", 
               RowBox[{"Q", "[", 
                RowBox[{"m", ",", "n", ",", "i", ",", "jm1", ",", "k"}], 
                "]"}]}], ")"}], "*", 
             RowBox[{"dy1", "/", "2"}]}]}]}], "\[IndentingNewLine]", "/.", 
          RowBox[{
           RowBox[{"Q", "[", 
            RowBox[{"m_", ",", "n_", ",", 
             RowBox[{"x", "[", "2", "]"}]}], "]"}], "\[Rule]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Q", "[", 
               RowBox[{"m", ",", "n", ",", "i", ",", "j", ",", "kp1"}], "]"}],
               "-", 
              RowBox[{"Q", "[", 
               RowBox[{"m", ",", "n", ",", "i", ",", "j", ",", "km1"}], 
               "]"}]}], ")"}], "*", 
            RowBox[{"dz1", "/", "2"}]}]}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"r2", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"r3", "/.", 
               RowBox[{
                RowBox[{"Q", "[", 
                 RowBox[{"m_", ",", "n_", ",", 
                  RowBox[{"x", "[", "0", "]"}], ",", 
                  RowBox[{"x", "[", "0", "]"}]}], "]"}], "\[Rule]", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Q", "[", 
                    RowBox[{"m", ",", "n", ",", "ip1", ",", "j", ",", "k"}], 
                    "]"}], "-", 
                   RowBox[{"2", "*", 
                    RowBox[{"Q", "[", 
                    RowBox[{"m", ",", "n", ",", "i", ",", "j", ",", "k"}], 
                    "]"}]}], "+", 
                   RowBox[{"Q", "[", 
                    RowBox[{"m", ",", "n", ",", "im1", ",", "j", ",", "k"}], 
                    "]"}]}], ")"}], "*", "dx1", "*", "dx1"}]}]}], 
              "\[IndentingNewLine]", "/.", 
              RowBox[{
               RowBox[{"Q", "[", 
                RowBox[{"m_", ",", "n_", ",", 
                 RowBox[{"x", "[", "0", "]"}], ",", 
                 RowBox[{"x", "[", "1", "]"}]}], "]"}], "\[Rule]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Q", "[", 
                   RowBox[{"m", ",", "n", ",", "ip1", ",", "jp1", ",", "k"}], 
                   "]"}], "-", 
                  RowBox[{"Q", "[", 
                   RowBox[{"m", ",", "n", ",", "ip1", ",", "jm1", ",", "k"}], 
                   "]"}], "-", 
                  RowBox[{"Q", "[", 
                   RowBox[{"m", ",", "n", ",", "im1", ",", "jp1", ",", "k"}], 
                   "]"}], "+", 
                  RowBox[{"Q", "[", 
                   RowBox[{"m", ",", "n", ",", "im1", ",", "jm1", ",", "k"}], 
                   "]"}]}], ")"}], "*", "dx1", "*", 
                RowBox[{"dy1", "/", "4"}]}]}]}], "\[IndentingNewLine]", "/.", 
             
             RowBox[{
              RowBox[{"Q", "[", 
               RowBox[{"m_", ",", "n_", ",", 
                RowBox[{"x", "[", "0", "]"}], ",", 
                RowBox[{"x", "[", "2", "]"}]}], "]"}], "\[Rule]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Q", "[", 
                  RowBox[{"m", ",", "n", ",", "ip1", ",", "j", ",", "kp1"}], 
                  "]"}], "-", 
                 RowBox[{"Q", "[", 
                  RowBox[{"m", ",", "n", ",", "ip1", ",", "j", ",", "km1"}], 
                  "]"}], "-", 
                 RowBox[{"Q", "[", 
                  RowBox[{"m", ",", "n", ",", "im1", ",", "j", ",", "kp1"}], 
                  "]"}], "+", 
                 RowBox[{"Q", "[", 
                  RowBox[{"m", ",", "n", ",", "im1", ",", "j", ",", "km1"}], 
                  "]"}]}], ")"}], "*", "dx1", "*", 
               RowBox[{"dz1", "/", "4"}]}]}]}], "\[IndentingNewLine]", "/.", 
            RowBox[{
             RowBox[{"Q", "[", 
              RowBox[{"m_", ",", "n_", ",", 
               RowBox[{"x", "[", "1", "]"}], ",", 
               RowBox[{"x", "[", "1", "]"}]}], "]"}], "\[Rule]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Q", "[", 
                 RowBox[{"m", ",", "n", ",", "i", ",", "jp1", ",", "k"}], 
                 "]"}], "-", 
                RowBox[{"2", "*", 
                 RowBox[{"Q", "[", 
                  RowBox[{"m", ",", "n", ",", "i", ",", "j", ",", "k"}], 
                  "]"}]}], "+", 
                RowBox[{"Q", "[", 
                 RowBox[{"m", ",", "n", ",", "i", ",", "jm1", ",", "k"}], 
                 "]"}]}], ")"}], "*", "dy1", "*", "dy1"}]}]}], 
           "\[IndentingNewLine]", "/.", 
           RowBox[{
            RowBox[{"Q", "[", 
             RowBox[{"m_", ",", "n_", ",", 
              RowBox[{"x", "[", "1", "]"}], ",", 
              RowBox[{"x", "[", "2", "]"}]}], "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Q", "[", 
                RowBox[{"m", ",", "n", ",", "i", ",", "jp1", ",", "kp1"}], 
                "]"}], "-", 
               RowBox[{"Q", "[", 
                RowBox[{"m", ",", "n", ",", "i", ",", "jp1", ",", "km1"}], 
                "]"}], "-", 
               RowBox[{"Q", "[", 
                RowBox[{"m", ",", "n", ",", "i", ",", "jm1", ",", "kp1"}], 
                "]"}], "+", 
               RowBox[{"Q", "[", 
                RowBox[{"m", ",", "n", ",", "i", ",", "jm1", ",", "km1"}], 
                "]"}]}], ")"}], "*", "dy1", "*", 
             RowBox[{"dz1", "/", "4"}]}]}]}], "\[IndentingNewLine]", "/.", 
          RowBox[{
           RowBox[{"Q", "[", 
            RowBox[{"m_", ",", "n_", ",", 
             RowBox[{"x", "[", "2", "]"}], ",", 
             RowBox[{"x", "[", "2", "]"}]}], "]"}], "\[Rule]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Q", "[", 
               RowBox[{"m", ",", "n", ",", "i", ",", "j", ",", "kp1"}], "]"}],
               "-", 
              RowBox[{"2", "*", 
               RowBox[{"Q", "[", 
                RowBox[{"m", ",", "n", ",", "i", ",", "j", ",", "k"}], 
                "]"}]}], "+", 
              RowBox[{"Q", "[", 
               RowBox[{"m", ",", "n", ",", "i", ",", "j", ",", "km1"}], 
               "]"}]}], ")"}], "*", "dz1", "*", "dz1"}]}]}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"jacobian", "[", 
      RowBox[{
      "m_", ",", "n_", ",", "mm_", ",", "nn_", ",", "i_", ",", "j_", ",", 
       "k_"}], "]"}], ":=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"jacExpand", "[", 
         RowBox[{"FullSimplify", "[", 
          RowBox[{
           RowBox[{"symmetrizeQ", "[", 
            RowBox[{"bulkBeris", "[", 
             RowBox[{"m", ",", "n"}], "]"}], "]"}], "/.", "preRules"}], "]"}],
          "]"}], ",", 
        RowBox[{"Q", "[", 
         RowBox[{"mm", ",", "nn", ",", "i", ",", "j", ",", "k"}], "]"}]}], 
       "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"jactocode", "[", 
      RowBox[{
      "m_", ",", "n_", ",", "mm_", ",", "nn_", ",", "ii_", ",", "jj_", ",", 
       "kk_"}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<idxm[0]=\>\"", ",", 
       RowBox[{"postionCreator", "[", 
        RowBox[{"m", ",", "n", ",", "i", ",", "j", ",", "k"}], "]"}], ",", 
       "\"\<;\\n\>\"", ",", "\[IndentingNewLine]", "\"\<idxn[0]=\>\"", ",", 
       RowBox[{"postionCreator", "[", 
        RowBox[{"mm", ",", "nn", ",", "ii", ",", "jj", ",", "kk"}], "]"}], 
       ",", "\"\<;\\n\>\"", ",", "\[IndentingNewLine]", 
       "\"\<Jac_values[0]=\>\"", ",", "\"\<Lambda*(\>\"", ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"CForm", "[", 
           RowBox[{"jacobian", "[", 
            RowBox[{
            "m", ",", "n", ",", "mm", ",", "nn", ",", "ii", ",", "jj", ",", 
             "kk"}], "]"}], "]"}], "]"}], ",", "jacRules"}], "]"}], ",", 
       "\"\<);\\n\>\"", ",", "\[IndentingNewLine]", 
       "\"\<MatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\n\>\""}\
], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FormatCode", "[", "code_String", "]"}], ":=", 
     RowBox[{"StringReplace", "[", 
      RowBox[{"code", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
          "RegularExpression", "[", 
           "\"\<Q\\\\(0,0,([ijpm1]*),([jpm1]*),([kmp1]*)\\\\)\>\"", "]"}], 
          "\[Rule]", "\"\<Qij[5*(Nx*(Ny*$3+$2)+$1)+0]\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "RegularExpression", "[", 
           "\"\<Q\\\\(0,1,([ijpm1]*),([jpm1]*),([kmp1]*)\\\\)\>\"", "]"}], 
          "\[Rule]", "\"\<Qij[5*(Nx*(Ny*$3+$2)+$1)+1]\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "RegularExpression", "[", 
           "\"\<Q\\\\(0,2,([ijpm1]*),([jpm1]*),([kmp1]*)\\\\)\>\"", "]"}], 
          "\[Rule]", "\"\<Qij[5*(Nx*(Ny*$3+$2)+$1)+2]\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "RegularExpression", "[", 
           "\"\<Q\\\\(1,1,([ijpm1]*),([jpm1]*),([kmp1]*)\\\\)\>\"", "]"}], 
          "\[Rule]", "\"\<Qij[5*(Nx*(Ny*$3+$2)+$1)+3]\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "RegularExpression", "[", 
           "\"\<Q\\\\(1,2,([ijpm1]*),([jpm1]*),([kmp1]*)\\\\)\>\"", "]"}], 
          "\[Rule]", "\"\<Qij[5*(Nx*(Ny*$3+$2)+$1)+4]\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<dx1\>\"", "\[Rule]", "\"\<dx_1\>\""}], ",", 
         RowBox[{"\"\<dy1\>\"", "\[Rule]", "\"\<dy_1\>\""}], ",", 
         RowBox[{"\"\<dz1\>\"", "\[Rule]", "\"\<dz_1\>\""}], ",", 
         RowBox[{"\"\<l1\>\"", "\[Rule]", "\"\<L1\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<l2\>\"", "\[Rule]", "\"\<L2\>\""}], ",", 
         RowBox[{"\"\<l3\>\"", "\[Rule]", "\"\<L3\>\""}], ",", 
         RowBox[{"\"\<lq\>\"", "\[Rule]", "\"\<Lq_tilde\>\""}], ",", 
         RowBox[{"\"\<ls\>\"", "\[Rule]", "\"\<Ls\>\""}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{
     "i", ",", "j", ",", "k", ",", "ip1", ",", "im1", ",", "jp1", ",", "jm1", 
      ",", "kp1", ",", "km1"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"is", "=", 
     RowBox[{"{", 
      RowBox[{"i", ",", "ip1", ",", "im1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"js", "=", 
     RowBox[{"{", 
      RowBox[{"j", ",", "jp1", ",", "jm1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ks", "=", 
     RowBox[{"{", 
      RowBox[{"k", ",", "kp1", ",", "km1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"JacobianString", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"ii", "=", "0"}], ",", 
      RowBox[{"ii", "\[LessEqual]", "2"}], ",", 
      RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"jj", "=", "0"}], ",", 
        RowBox[{"jj", "\[LessEqual]", "2"}], ",", 
        RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"kk", "=", "0"}], ",", 
          RowBox[{"kk", "\[LessEqual]", "2"}], ",", 
          RowBox[{"kk", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"ll", "=", "0"}], ",", 
            RowBox[{"ll", "\[LessEqual]", "2"}], ",", 
            RowBox[{"ll", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"il", "=", "0"}], ",", 
              RowBox[{"il", "\[LessEqual]", "2"}], ",", 
              RowBox[{
               RowBox[{"il", "++"}], ";", "\[IndentingNewLine]", 
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"jl", "=", "0"}], ",", 
                 RowBox[{"jl", "\[LessEqual]", "2"}], ",", 
                 RowBox[{
                  RowBox[{"jl", "++"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"For", "[", 
                   RowBox[{
                    RowBox[{"kl", "=", "0"}], ",", 
                    RowBox[{"kl", "\[LessEqual]", "2"}], ",", 
                    RowBox[{
                    RowBox[{"kl", "++"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"code", "=", 
                    RowBox[{"jactocode", "[", 
                    RowBox[{"ii", ",", "jj", ",", "kk", ",", "ll", ",", 
                    RowBox[{"is", "[", 
                    RowBox[{"[", "il", "]"}], "]"}], ",", 
                    RowBox[{"js", "[", 
                    RowBox[{"[", "jl", "]"}], "]"}], ",", 
                    RowBox[{"ks", "[", 
                    RowBox[{"[", "kl", "]"}], "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{"code", ",", "\"\<*None*\>\""}], "]"}]}], " ", "&&",
                     " ", 
                    RowBox[{"!", 
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    "code", ",", "\"\<*Jac_values[0]=Lambda*(0);*\>\""}], 
                    "]"}]}]}], " ", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"JacobianString", ",", 
                    RowBox[{"FormatCode", "[", "code", "]"}]}], "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
                   "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
                "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.712351735519821*^9, 3.7123518031342287`*^9}, {
   3.712351840675023*^9, 3.7123518824253063`*^9}, {3.712351917329198*^9, 
   3.712351981512738*^9}, {3.71235212290189*^9, 3.7123521957447023`*^9}, {
   3.7123522414973793`*^9, 3.712352305433928*^9}, {3.712352382307222*^9, 
   3.71235242441838*^9}, {3.712352650942357*^9, 3.7123526510703583`*^9}, {
   3.7123528100640993`*^9, 3.712352831272753*^9}, {3.712352879428207*^9, 
   3.7123529113106327`*^9}, {3.712352964107424*^9, 3.7123530669658012`*^9}, {
   3.712353169838007*^9, 3.712353188540889*^9}, {3.712353701797061*^9, 
   3.712353742002483*^9}, {3.712354101699255*^9, 3.712354102102159*^9}, 
   3.712399850007556*^9, {3.7123998977810373`*^9, 3.7123998990724154`*^9}, {
   3.71239998464242*^9, 3.712399985128079*^9}, {3.7124216399137707`*^9, 
   3.712421640100296*^9}, {3.714210022550364*^9, 3.714210033876194*^9}, {
   3.777973400502001*^9, 3.777973416425743*^9}, {3.777974335141182*^9, 
   3.777974392095272*^9}, {3.777978009361458*^9, 3.777978145880453*^9}, {
   3.777978208977231*^9, 3.7779782190766373`*^9}, {3.777989612249035*^9, 
   3.777989631187931*^9}, {3.777989668050536*^9, 3.777989682958748*^9}, {
   3.7779898961548147`*^9, 3.7779899195839357`*^9}, {3.7779900251781673`*^9, 
   3.777990047258813*^9}, {3.777990634259972*^9, 3.777990830581463*^9}, {
   3.777990874006482*^9, 3.777990957726962*^9}, {3.7779909893103247`*^9, 
   3.777991100164693*^9}, {3.7779911308245068`*^9, 3.7779912402055483`*^9}, {
   3.77799511251624*^9, 3.777995115661577*^9}, {3.777995160751238*^9, 
   3.777995176852516*^9}, {3.777995214128257*^9, 3.777995231475806*^9}, {
   3.777995321358921*^9, 3.777995358957563*^9}, {3.777995395302219*^9, 
   3.77799541390812*^9}, {3.777995530524941*^9, 3.777995562274479*^9}, {
   3.777995709290536*^9, 3.777995727726698*^9}, {3.777995773236932*^9, 
   3.7779957809700937`*^9}, {3.777996477334248*^9, 3.7779964965625973`*^9}, {
   3.777996529456726*^9, 3.77799655481758*^9}, {3.777996594918902*^9, 
   3.77799659844976*^9}, {3.777996675011284*^9, 3.777996680535243*^9}, {
   3.777996755591378*^9, 3.777996759871866*^9}, {3.777996901723236*^9, 
   3.7779969595388117`*^9}, {3.777997027264185*^9, 3.777997091970533*^9}, {
   3.777997454019331*^9, 3.777997455948635*^9}, {3.778000456384664*^9, 
   3.778000474071685*^9}, {3.7780005318230963`*^9, 3.778000628103608*^9}, {
   3.7782306973946943`*^9, 3.778230786150381*^9}, {3.7782308275411654`*^9, 
   3.778230861318914*^9}, 3.778231586288237*^9, 3.778231668741682*^9, {
   3.778246006318022*^9, 3.778246025187179*^9}, {3.7782467686661663`*^9, 
   3.778246800572111*^9}, {3.778246869096373*^9, 3.778246873079636*^9}, {
   3.7782469684422207`*^9, 3.778247042924409*^9}, {3.778247152436146*^9, 
   3.778247153704688*^9}, {3.778247483636526*^9, 3.778247588274004*^9}, {
   3.778247622159644*^9, 3.7782476222809*^9}, 3.778247687433399*^9, {
   3.7782477324664383`*^9, 3.778247771103362*^9}, {3.778248056656219*^9, 
   3.778248070551538*^9}, 3.778248309795795*^9, {3.778249432656989*^9, 
   3.7782494798514833`*^9}, {3.778249651034206*^9, 3.778249710222506*^9}, 
   3.778250092489756*^9, {3.778250177531087*^9, 3.778250313149768*^9}, 
   3.7782507474286957`*^9, 3.7782538532324753`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringJoin", "[", "JacobianString", "]"}]], "Input",
 CellChangeTimes->{{3.7782309172281*^9, 3.7782309651818933`*^9}, {
  3.778232759223735*^9, 3.7782327647433367`*^9}}],

Cell[BoxData["\<\"idxm[0]=5*(Nx*(Ny*k+j)+i)+0;\\nidxn[0]=5*(Nx*(Ny*k+j)+i)+0;\
\\nJac_values[0]=Lambda*(-2*((dx_1*dx_1) + (dy_1*dy_1) + (dz_1*dz_1))*L1 - \
sigma - (2*(9*cc*(Qij[5*(Nx*(Ny*k+j)+i)+0]*Qij[5*(Nx*(Ny*k+j)+i)+0]) - \
bb*Qij[5*(Nx*(Ny*k+j)+i)+3] + Qij[5*(Nx*(Ny*k+j)+i)+0]*(bb + \
6*cc*Qij[5*(Nx*(Ny*k+j)+i)+3]) + \
3*cc*((Qij[5*(Nx*(Ny*k+j)+i)+1]*Qij[5*(Nx*(Ny*k+j)+i)+1]) + \
(Qij[5*(Nx*(Ny*k+j)+i)+2]*Qij[5*(Nx*(Ny*k+j)+i)+2]) + \
(Qij[5*(Nx*(Ny*k+j)+i)+3]*Qij[5*(Nx*(Ny*k+j)+i)+3]) + \
(Qij[5*(Nx*(Ny*k+j)+i)+4]*Qij[5*(Nx*(Ny*k+j)+i)+4]))))/3.);\\nMatSetValues(\
Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+0;\\\
nidxn[0]=5*(Nx*(Ny*kp1+j)+i)+0;\\nJac_values[0]=Lambda*((dz_1*dz_1)*L1);\\\
nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(\
Ny*k+j)+i)+0;\\nidxn[0]=5*(Nx*(Ny*km1+j)+i)+0;\\nJac_values[0]=Lambda*((dz_1*\
dz_1)*L1);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[\
0]=5*(Nx*(Ny*k+j)+i)+0;\\nidxn[0]=5*(Nx*(Ny*k+jp1)+i)+0;\\nJac_values[0]=\
Lambda*((dy_1*dy_1)*L1);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_\
VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+0;\\nidxn[0]=5*(Nx*(Ny*k+jm1)+i)+0;\\\
nJac_values[0]=Lambda*((dy_1*dy_1)*L1);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_\
values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+0;\\nidxn[0]=5*(Nx*(Ny*k+j)\
+ip1)+0;\\nJac_values[0]=Lambda*((dx_1*dx_1)*L1);\\nMatSetValues(Jac,1,idxm,1,\
idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+0;\\nidxn[0]=5*(\
Nx*(Ny*k+j)+im1)+0;\\nJac_values[0]=Lambda*((dx_1*dx_1)*L1);\\nMatSetValues(\
Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+0;\\\
nidxn[0]=5*(Nx*(Ny*k+j)+i)+1;\\nJac_values[0]=Lambda*((-2*(bb + \
6*cc*Qij[5*(Nx*(Ny*k+j)+i)+0])*Qij[5*(Nx*(Ny*k+j)+i)+1])/3.);\\nMatSetValues(\
Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+0;\\\
nidxn[0]=5*(Nx*(Ny*kp1+j)+i)+1;\\nJac_values[0]=Lambda*(dz_1*Lq_tilde);\\\
nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(\
Ny*k+j)+i)+0;\\nidxn[0]=5*(Nx*(Ny*km1+j)+i)+1;\\nJac_values[0]=Lambda*(-(dz_1*\
Lq_tilde));\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\\
nidxm[0]=5*(Nx*(Ny*k+j)+i)+0;\\nidxn[0]=5*(Nx*(Ny*k+j)+i)+2;\\nJac_values[0]=\
Lambda*((-2*(bb + \
6*cc*Qij[5*(Nx*(Ny*k+j)+i)+0])*Qij[5*(Nx*(Ny*k+j)+i)+2])/3.);\\nMatSetValues(\
Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+0;\\\
nidxn[0]=5*(Nx*(Ny*k+jp1)+i)+2;\\nJac_values[0]=Lambda*(-(dy_1*Lq_tilde));\\\
nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(\
Ny*k+j)+i)+0;\\nidxn[0]=5*(Nx*(Ny*k+jm1)+i)+2;\\nJac_values[0]=Lambda*(dy_1*\
Lq_tilde);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[\
0]=5*(Nx*(Ny*k+j)+i)+0;\\nidxn[0]=5*(Nx*(Ny*k+j)+i)+3;\\nJac_values[0]=Lambda*\
((2*(bb - 3*cc*Qij[5*(Nx*(Ny*k+j)+i)+0])*(Qij[5*(Nx*(Ny*k+j)+i)+0] + \
2*Qij[5*(Nx*(Ny*k+j)+i)+3]))/3.);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,\
ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+0;\\nidxn[0]=5*(Nx*(Ny*k+j)+i)+4;\
\\nJac_values[0]=Lambda*((4*(bb - \
3*cc*Qij[5*(Nx*(Ny*k+j)+i)+0])*Qij[5*(Nx*(Ny*k+j)+i)+4])/3.);\\nMatSetValues(\
Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+1;\\\
nidxn[0]=5*(Nx*(Ny*k+j)+i)+0;\\nJac_values[0]=Lambda*(-(Qij[5*(Nx*(Ny*k+j)+i)+\
1]*(bb + 4*cc*Qij[5*(Nx*(Ny*k+j)+i)+0] + \
2*cc*Qij[5*(Nx*(Ny*k+j)+i)+3])));\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,\
ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+1;\\nidxn[0]=5*(Nx*(Ny*kp1+j)+i)+\
0;\\nJac_values[0]=Lambda*(-(dz_1*Lq_tilde)/2.);\\nMatSetValues(Jac,1,idxm,1,\
idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+1;\\nidxn[0]=5*(\
Nx*(Ny*km1+j)+i)+0;\\nJac_values[0]=Lambda*((dz_1*Lq_tilde)/2.);\\\
nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(\
Ny*k+j)+i)+1;\\nidxn[0]=5*(Nx*(Ny*k+j)+i)+1;\\nJac_values[0]=Lambda*(-2*((dx_\
1*dx_1) + (dy_1*dy_1) + (dz_1*dz_1))*L1 - sigma - \
2*cc*(Qij[5*(Nx*(Ny*k+j)+i)+0]*Qij[5*(Nx*(Ny*k+j)+i)+0]) - \
bb*Qij[5*(Nx*(Ny*k+j)+i)+3] - Qij[5*(Nx*(Ny*k+j)+i)+0]*(bb + \
2*cc*Qij[5*(Nx*(Ny*k+j)+i)+3]) - \
2*cc*(3*(Qij[5*(Nx*(Ny*k+j)+i)+1]*Qij[5*(Nx*(Ny*k+j)+i)+1]) + \
(Qij[5*(Nx*(Ny*k+j)+i)+2]*Qij[5*(Nx*(Ny*k+j)+i)+2]) + \
(Qij[5*(Nx*(Ny*k+j)+i)+3]*Qij[5*(Nx*(Ny*k+j)+i)+3]) + \
(Qij[5*(Nx*(Ny*k+j)+i)+4]*Qij[5*(Nx*(Ny*k+j)+i)+4])));\\nMatSetValues(Jac,1,\
idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+1;\\nidxn[\
0]=5*(Nx*(Ny*kp1+j)+i)+1;\\nJac_values[0]=Lambda*((dz_1*dz_1)*L1);\\\
nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(\
Ny*k+j)+i)+1;\\nidxn[0]=5*(Nx*(Ny*km1+j)+i)+1;\\nJac_values[0]=Lambda*((dz_1*\
dz_1)*L1);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[\
0]=5*(Nx*(Ny*k+j)+i)+1;\\nidxn[0]=5*(Nx*(Ny*k+jp1)+i)+1;\\nJac_values[0]=\
Lambda*((dy_1*dy_1)*L1);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_\
VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+1;\\nidxn[0]=5*(Nx*(Ny*k+jm1)+i)+1;\\\
nJac_values[0]=Lambda*((dy_1*dy_1)*L1);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_\
values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+1;\\nidxn[0]=5*(Nx*(Ny*k+j)\
+ip1)+1;\\nJac_values[0]=Lambda*((dx_1*dx_1)*L1);\\nMatSetValues(Jac,1,idxm,1,\
idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+1;\\nidxn[0]=5*(\
Nx*(Ny*k+j)+im1)+1;\\nJac_values[0]=Lambda*((dx_1*dx_1)*L1);\\nMatSetValues(\
Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+1;\\\
nidxn[0]=5*(Nx*(Ny*k+j)+i)+2;\\nJac_values[0]=Lambda*(-4*cc*Qij[5*(Nx*(Ny*k+j)\
+i)+1]*Qij[5*(Nx*(Ny*k+j)+i)+2] - \
bb*Qij[5*(Nx*(Ny*k+j)+i)+4]);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_\
VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+1;\\nidxn[0]=5*(Nx*(Ny*k+j)+ip1)+2;\\\
nJac_values[0]=Lambda*((dx_1*Lq_tilde)/2.);\\nMatSetValues(Jac,1,idxm,1,idxn,\
Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+1;\\nidxn[0]=5*(Nx*(Ny*\
k+j)+im1)+2;\\nJac_values[0]=Lambda*(-(dx_1*Lq_tilde)/2.);\\nMatSetValues(Jac,\
1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+1;\\\
nidxn[0]=5*(Nx*(Ny*k+j)+i)+3;\\nJac_values[0]=Lambda*(-(Qij[5*(Nx*(Ny*k+j)+i)+\
1]*(bb + 2*cc*Qij[5*(Nx*(Ny*k+j)+i)+0] + \
4*cc*Qij[5*(Nx*(Ny*k+j)+i)+3])));\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,\
ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+1;\\nidxn[0]=5*(Nx*(Ny*kp1+j)+i)+\
3;\\nJac_values[0]=Lambda*((dz_1*Lq_tilde)/2.);\\nMatSetValues(Jac,1,idxm,1,\
idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+1;\\nidxn[0]=5*(\
Nx*(Ny*km1+j)+i)+3;\\nJac_values[0]=Lambda*(-(dz_1*Lq_tilde)/2.);\\\
nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(\
Ny*k+j)+i)+1;\\nidxn[0]=5*(Nx*(Ny*k+j)+i)+4;\\nJac_values[0]=Lambda*(-(bb*Qij[\
5*(Nx*(Ny*k+j)+i)+2]) - \
4*cc*Qij[5*(Nx*(Ny*k+j)+i)+1]*Qij[5*(Nx*(Ny*k+j)+i)+4]);\\nMatSetValues(Jac,1,\
idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+1;\\nidxn[\
0]=5*(Nx*(Ny*k+jp1)+i)+4;\\nJac_values[0]=Lambda*(-(dy_1*Lq_tilde)/2.);\\\
nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(\
Ny*k+j)+i)+1;\\nidxn[0]=5*(Nx*(Ny*k+jm1)+i)+4;\\nJac_values[0]=Lambda*((dy_1*\
Lq_tilde)/2.);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\\
nidxm[0]=5*(Nx*(Ny*k+j)+i)+2;\\nidxn[0]=5*(Nx*(Ny*k+j)+i)+0;\\nJac_values[0]=\
Lambda*(-2*cc*Qij[5*(Nx*(Ny*k+j)+i)+2]*(2*Qij[5*(Nx*(Ny*k+j)+i)+0] + \
Qij[5*(Nx*(Ny*k+j)+i)+3]));\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_\
VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+2;\\nidxn[0]=5*(Nx*(Ny*k+jp1)+i)+0;\\\
nJac_values[0]=Lambda*(dy_1*Lq_tilde);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_\
values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+2;\\nidxn[0]=5*(Nx*(Ny*k+\
jm1)+i)+0;\\nJac_values[0]=Lambda*(-(dy_1*Lq_tilde));\\nMatSetValues(Jac,1,\
idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+2;\\nidxn[\
0]=5*(Nx*(Ny*k+j)+i)+1;\\nJac_values[0]=Lambda*(-4*cc*Qij[5*(Nx*(Ny*k+j)+i)+1]\
*Qij[5*(Nx*(Ny*k+j)+i)+2] - \
bb*Qij[5*(Nx*(Ny*k+j)+i)+4]);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_\
VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+2;\\nidxn[0]=5*(Nx*(Ny*k+j)+ip1)+1;\\\
nJac_values[0]=Lambda*(-(dx_1*Lq_tilde)/2.);\\nMatSetValues(Jac,1,idxm,1,idxn,\
Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+2;\\nidxn[0]=5*(Nx*(Ny*\
k+j)+im1)+1;\\nJac_values[0]=Lambda*((dx_1*Lq_tilde)/2.);\\nMatSetValues(Jac,\
1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+2;\\\
nidxn[0]=5*(Nx*(Ny*k+j)+i)+2;\\nJac_values[0]=Lambda*(-2*((dx_1*dx_1) + \
(dy_1*dy_1) + (dz_1*dz_1))*L1 - sigma + bb*Qij[5*(Nx*(Ny*k+j)+i)+3] - \
2*cc*((Qij[5*(Nx*(Ny*k+j)+i)+0]*Qij[5*(Nx*(Ny*k+j)+i)+0]) + \
(Qij[5*(Nx*(Ny*k+j)+i)+1]*Qij[5*(Nx*(Ny*k+j)+i)+1]) + \
3*(Qij[5*(Nx*(Ny*k+j)+i)+2]*Qij[5*(Nx*(Ny*k+j)+i)+2]) + \
Qij[5*(Nx*(Ny*k+j)+i)+0]*Qij[5*(Nx*(Ny*k+j)+i)+3] + \
(Qij[5*(Nx*(Ny*k+j)+i)+3]*Qij[5*(Nx*(Ny*k+j)+i)+3]) + \
(Qij[5*(Nx*(Ny*k+j)+i)+4]*Qij[5*(Nx*(Ny*k+j)+i)+4])));\\nMatSetValues(Jac,1,\
idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+2;\\nidxn[\
0]=5*(Nx*(Ny*kp1+j)+i)+2;\\nJac_values[0]=Lambda*((dz_1*dz_1)*L1);\\\
nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(\
Ny*k+j)+i)+2;\\nidxn[0]=5*(Nx*(Ny*km1+j)+i)+2;\\nJac_values[0]=Lambda*((dz_1*\
dz_1)*L1);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[\
0]=5*(Nx*(Ny*k+j)+i)+2;\\nidxn[0]=5*(Nx*(Ny*k+jp1)+i)+2;\\nJac_values[0]=\
Lambda*((dy_1*dy_1)*L1);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_\
VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+2;\\nidxn[0]=5*(Nx*(Ny*k+jm1)+i)+2;\\\
nJac_values[0]=Lambda*((dy_1*dy_1)*L1);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_\
values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+2;\\nidxn[0]=5*(Nx*(Ny*k+j)\
+ip1)+2;\\nJac_values[0]=Lambda*((dx_1*dx_1)*L1);\\nMatSetValues(Jac,1,idxm,1,\
idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+2;\\nidxn[0]=5*(\
Nx*(Ny*k+j)+im1)+2;\\nJac_values[0]=Lambda*((dx_1*dx_1)*L1);\\nMatSetValues(\
Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+2;\\\
nidxn[0]=5*(Nx*(Ny*k+j)+i)+3;\\nJac_values[0]=Lambda*(Qij[5*(Nx*(Ny*k+j)+i)+2]\
*(bb - 2*cc*(Qij[5*(Nx*(Ny*k+j)+i)+0] + \
2*Qij[5*(Nx*(Ny*k+j)+i)+3])));\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,\
ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+2;\\nidxn[0]=5*(Nx*(Ny*k+jp1)+i)+\
3;\\nJac_values[0]=Lambda*((dy_1*Lq_tilde)/2.);\\nMatSetValues(Jac,1,idxm,1,\
idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+2;\\nidxn[0]=5*(\
Nx*(Ny*k+jm1)+i)+3;\\nJac_values[0]=Lambda*(-(dy_1*Lq_tilde)/2.);\\\
nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(\
Ny*k+j)+i)+2;\\nidxn[0]=5*(Nx*(Ny*k+j)+i)+4;\\nJac_values[0]=Lambda*(-(bb*Qij[\
5*(Nx*(Ny*k+j)+i)+1]) - \
4*cc*Qij[5*(Nx*(Ny*k+j)+i)+2]*Qij[5*(Nx*(Ny*k+j)+i)+4]);\\nMatSetValues(Jac,1,\
idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+2;\\nidxn[\
0]=5*(Nx*(Ny*kp1+j)+i)+4;\\nJac_values[0]=Lambda*((dz_1*Lq_tilde)/2.);\\\
nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(\
Ny*k+j)+i)+2;\\nidxn[0]=5*(Nx*(Ny*km1+j)+i)+4;\\nJac_values[0]=Lambda*(-(dz_1*\
Lq_tilde)/2.);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\\
nidxm[0]=5*(Nx*(Ny*k+j)+i)+3;\\nidxn[0]=5*(Nx*(Ny*k+j)+i)+0;\\nJac_values[0]=\
Lambda*((2*(2*Qij[5*(Nx*(Ny*k+j)+i)+0] + Qij[5*(Nx*(Ny*k+j)+i)+3])*(bb - \
3*cc*Qij[5*(Nx*(Ny*k+j)+i)+3]))/3.);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_\
values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+3;\\nidxn[0]=5*(Nx*(Ny*k+j)\
+i)+1;\\nJac_values[0]=Lambda*((-2*Qij[5*(Nx*(Ny*k+j)+i)+1]*(bb + \
6*cc*Qij[5*(Nx*(Ny*k+j)+i)+3]))/3.);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_\
values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+3;\\nidxn[0]=5*(Nx*(Ny*kp1+\
j)+i)+1;\\nJac_values[0]=Lambda*(-(dz_1*Lq_tilde));\\nMatSetValues(Jac,1,idxm,\
1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+3;\\nidxn[0]=5*(\
Nx*(Ny*km1+j)+i)+1;\\nJac_values[0]=Lambda*(dz_1*Lq_tilde);\\nMatSetValues(\
Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+3;\\\
nidxn[0]=5*(Nx*(Ny*k+j)+i)+2;\\nJac_values[0]=Lambda*((4*Qij[5*(Nx*(Ny*k+j)+i)\
+2]*(bb - \
3*cc*Qij[5*(Nx*(Ny*k+j)+i)+3]))/3.);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_\
values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+3;\\nidxn[0]=5*(Nx*(Ny*k+j)\
+i)+3;\\nJac_values[0]=Lambda*(-2*((dx_1*dx_1) + (dy_1*dy_1) + \
(dz_1*dz_1))*L1 - sigma - \
(2*(3*cc*(Qij[5*(Nx*(Ny*k+j)+i)+0]*Qij[5*(Nx*(Ny*k+j)+i)+0]) + \
bb*Qij[5*(Nx*(Ny*k+j)+i)+3] - Qij[5*(Nx*(Ny*k+j)+i)+0]*(bb - \
6*cc*Qij[5*(Nx*(Ny*k+j)+i)+3]) + \
3*cc*((Qij[5*(Nx*(Ny*k+j)+i)+1]*Qij[5*(Nx*(Ny*k+j)+i)+1]) + \
(Qij[5*(Nx*(Ny*k+j)+i)+2]*Qij[5*(Nx*(Ny*k+j)+i)+2]) + \
3*(Qij[5*(Nx*(Ny*k+j)+i)+3]*Qij[5*(Nx*(Ny*k+j)+i)+3]) + \
(Qij[5*(Nx*(Ny*k+j)+i)+4]*Qij[5*(Nx*(Ny*k+j)+i)+4]))))/3.);\\nMatSetValues(\
Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+3;\\\
nidxn[0]=5*(Nx*(Ny*kp1+j)+i)+3;\\nJac_values[0]=Lambda*((dz_1*dz_1)*L1);\\\
nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(\
Ny*k+j)+i)+3;\\nidxn[0]=5*(Nx*(Ny*km1+j)+i)+3;\\nJac_values[0]=Lambda*((dz_1*\
dz_1)*L1);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[\
0]=5*(Nx*(Ny*k+j)+i)+3;\\nidxn[0]=5*(Nx*(Ny*k+jp1)+i)+3;\\nJac_values[0]=\
Lambda*((dy_1*dy_1)*L1);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_\
VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+3;\\nidxn[0]=5*(Nx*(Ny*k+jm1)+i)+3;\\\
nJac_values[0]=Lambda*((dy_1*dy_1)*L1);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_\
values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+3;\\nidxn[0]=5*(Nx*(Ny*k+j)\
+ip1)+3;\\nJac_values[0]=Lambda*((dx_1*dx_1)*L1);\\nMatSetValues(Jac,1,idxm,1,\
idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+3;\\nidxn[0]=5*(\
Nx*(Ny*k+j)+im1)+3;\\nJac_values[0]=Lambda*((dx_1*dx_1)*L1);\\nMatSetValues(\
Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+3;\\\
nidxn[0]=5*(Nx*(Ny*k+j)+i)+4;\\nJac_values[0]=Lambda*((-2*(bb + \
6*cc*Qij[5*(Nx*(Ny*k+j)+i)+3])*Qij[5*(Nx*(Ny*k+j)+i)+4])/3.);\\nMatSetValues(\
Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+3;\\\
nidxn[0]=5*(Nx*(Ny*k+j)+ip1)+4;\\nJac_values[0]=Lambda*(dx_1*Lq_tilde);\\\
nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(\
Ny*k+j)+i)+3;\\nidxn[0]=5*(Nx*(Ny*k+j)+im1)+4;\\nJac_values[0]=Lambda*(-(dx_1*\
Lq_tilde));\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\\
nidxm[0]=5*(Nx*(Ny*k+j)+i)+4;\\nidxn[0]=5*(Nx*(Ny*k+j)+i)+0;\\nJac_values[0]=\
Lambda*((bb - 2*cc*(2*Qij[5*(Nx*(Ny*k+j)+i)+0] + \
Qij[5*(Nx*(Ny*k+j)+i)+3]))*Qij[5*(Nx*(Ny*k+j)+i)+4]);\\nMatSetValues(Jac,1,\
idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+4;\\nidxn[\
0]=5*(Nx*(Ny*k+j)+ip1)+0;\\nJac_values[0]=Lambda*(-(dx_1*Lq_tilde)/2.);\\\
nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(\
Ny*k+j)+i)+4;\\nidxn[0]=5*(Nx*(Ny*k+j)+im1)+0;\\nJac_values[0]=Lambda*((dx_1*\
Lq_tilde)/2.);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\\
nidxm[0]=5*(Nx*(Ny*k+j)+i)+4;\\nidxn[0]=5*(Nx*(Ny*k+j)+i)+1;\\nJac_values[0]=\
Lambda*(-(bb*Qij[5*(Nx*(Ny*k+j)+i)+2]) - \
4*cc*Qij[5*(Nx*(Ny*k+j)+i)+1]*Qij[5*(Nx*(Ny*k+j)+i)+4]);\\nMatSetValues(Jac,1,\
idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+4;\\nidxn[\
0]=5*(Nx*(Ny*k+jp1)+i)+1;\\nJac_values[0]=Lambda*((dy_1*Lq_tilde)/2.);\\\
nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(\
Ny*k+j)+i)+4;\\nidxn[0]=5*(Nx*(Ny*k+jm1)+i)+1;\\nJac_values[0]=Lambda*(-(dy_1*\
Lq_tilde)/2.);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\\
nidxm[0]=5*(Nx*(Ny*k+j)+i)+4;\\nidxn[0]=5*(Nx*(Ny*k+j)+i)+2;\\nJac_values[0]=\
Lambda*(-(bb*Qij[5*(Nx*(Ny*k+j)+i)+1]) - \
4*cc*Qij[5*(Nx*(Ny*k+j)+i)+2]*Qij[5*(Nx*(Ny*k+j)+i)+4]);\\nMatSetValues(Jac,1,\
idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+4;\\nidxn[\
0]=5*(Nx*(Ny*kp1+j)+i)+2;\\nJac_values[0]=Lambda*(-(dz_1*Lq_tilde)/2.);\\\
nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(\
Ny*k+j)+i)+4;\\nidxn[0]=5*(Nx*(Ny*km1+j)+i)+2;\\nJac_values[0]=Lambda*((dz_1*\
Lq_tilde)/2.);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\\
nidxm[0]=5*(Nx*(Ny*k+j)+i)+4;\\nidxn[0]=5*(Nx*(Ny*k+j)+i)+3;\\nJac_values[0]=\
Lambda*(-2*cc*(Qij[5*(Nx*(Ny*k+j)+i)+0] + \
2*Qij[5*(Nx*(Ny*k+j)+i)+3])*Qij[5*(Nx*(Ny*k+j)+i)+4]);\\nMatSetValues(Jac,1,\
idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+4;\\nidxn[\
0]=5*(Nx*(Ny*k+j)+ip1)+3;\\nJac_values[0]=Lambda*(-(dx_1*Lq_tilde));\\\
nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(\
Ny*k+j)+i)+4;\\nidxn[0]=5*(Nx*(Ny*k+j)+im1)+3;\\nJac_values[0]=Lambda*(dx_1*\
Lq_tilde);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[\
0]=5*(Nx*(Ny*k+j)+i)+4;\\nidxn[0]=5*(Nx*(Ny*k+j)+i)+4;\\nJac_values[0]=Lambda*\
(-2*((dx_1*dx_1) + (dy_1*dy_1) + (dz_1*dz_1))*L1 - sigma - \
2*cc*(Qij[5*(Nx*(Ny*k+j)+i)+0]*Qij[5*(Nx*(Ny*k+j)+i)+0]) + \
Qij[5*(Nx*(Ny*k+j)+i)+0]*(bb - 2*cc*Qij[5*(Nx*(Ny*k+j)+i)+3]) - \
2*cc*((Qij[5*(Nx*(Ny*k+j)+i)+1]*Qij[5*(Nx*(Ny*k+j)+i)+1]) + \
(Qij[5*(Nx*(Ny*k+j)+i)+2]*Qij[5*(Nx*(Ny*k+j)+i)+2]) + \
(Qij[5*(Nx*(Ny*k+j)+i)+3]*Qij[5*(Nx*(Ny*k+j)+i)+3]) + \
3*(Qij[5*(Nx*(Ny*k+j)+i)+4]*Qij[5*(Nx*(Ny*k+j)+i)+4])));\\nMatSetValues(Jac,1,\
idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+4;\\nidxn[\
0]=5*(Nx*(Ny*kp1+j)+i)+4;\\nJac_values[0]=Lambda*((dz_1*dz_1)*L1);\\\
nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(\
Ny*k+j)+i)+4;\\nidxn[0]=5*(Nx*(Ny*km1+j)+i)+4;\\nJac_values[0]=Lambda*((dz_1*\
dz_1)*L1);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\nidxm[\
0]=5*(Nx*(Ny*k+j)+i)+4;\\nidxn[0]=5*(Nx*(Ny*k+jp1)+i)+4;\\nJac_values[0]=\
Lambda*((dy_1*dy_1)*L1);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_values,ADD_\
VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+4;\\nidxn[0]=5*(Nx*(Ny*k+jm1)+i)+4;\\\
nJac_values[0]=Lambda*((dy_1*dy_1)*L1);\\nMatSetValues(Jac,1,idxm,1,idxn,Jac_\
values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+4;\\nidxn[0]=5*(Nx*(Ny*k+j)\
+ip1)+4;\\nJac_values[0]=Lambda*((dx_1*dx_1)*L1);\\nMatSetValues(Jac,1,idxm,1,\
idxn,Jac_values,ADD_VALUES);\\n\\nidxm[0]=5*(Nx*(Ny*k+j)+i)+4;\\nidxn[0]=5*(\
Nx*(Ny*k+j)+im1)+4;\\nJac_values[0]=Lambda*((dx_1*dx_1)*L1);\\nMatSetValues(\
Jac,1,idxm,1,idxn,Jac_values,ADD_VALUES);\\n\\n\"\>"], "Output",
 CellChangeTimes->{3.77824633143554*^9, 3.77824660099529*^9, 
  3.7782495573795347`*^9, 3.778249746529284*^9, 3.778249908420518*^9, 
  3.7782504623985653`*^9, 3.778254007565846*^9, 3.77825457860917*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Surface", "Section",
 CellChangeTimes->{{3.712399879654072*^9, 3.7123998807531023`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"jacSurfExpand", "[", "f_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"expresion", "=", "f"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r1", "=", 
        RowBox[{"expresion", "/.", 
         RowBox[{
          RowBox[{"Q", "[", 
           RowBox[{"m_", ",", "n_"}], "]"}], "\[Rule]", 
          RowBox[{"Q", "[", 
           RowBox[{"m", ",", "n", ",", "i", ",", "j", ",", "k"}], "]"}]}]}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"r2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"r1", "/.", 
           RowBox[{
            RowBox[{"Q", "[", 
             RowBox[{"m_", ",", "n_", ",", 
              RowBox[{"x", "[", "0", "]"}]}], "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Q", "[", 
                RowBox[{"m", ",", "n", ",", "ip1", ",", "j", ",", "k"}], 
                "]"}], "-", 
               RowBox[{"Q", "[", 
                RowBox[{"m", ",", "n", ",", "im1", ",", "j", ",", "k"}], 
                "]"}]}], ")"}], "/", "2"}]}]}], "\[IndentingNewLine]", "/.", 
          RowBox[{
           RowBox[{"Q", "[", 
            RowBox[{"m_", ",", "n_", ",", 
             RowBox[{"x", "[", "1", "]"}]}], "]"}], "\[Rule]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Q", "[", 
               RowBox[{"m", ",", "n", ",", "i", ",", "jp1", ",", "k"}], "]"}],
               "-", 
              RowBox[{"Q", "[", 
               RowBox[{"m", ",", "n", ",", "i", ",", "jm1", ",", "k"}], 
               "]"}]}], ")"}], "/", "2"}]}]}], "\[IndentingNewLine]", "/.", 
         RowBox[{
          RowBox[{"Q", "[", 
           RowBox[{"m_", ",", "n_", ",", 
            RowBox[{"x", "[", "2", "]"}]}], "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"Q", "[", 
            RowBox[{"m", ",", "n", ",", "i", ",", "j", ",", "kp1"}], "]"}], 
           "-", 
           RowBox[{"Q", "[", 
            RowBox[{"m", ",", "n", ",", "i", ",", "j", ",", "km1"}], 
            "]"}]}]}]}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"surfJacobian", "[", 
     RowBox[{
     "m_", ",", "n_", ",", "mm_", ",", "nn_", ",", "i_", ",", "j_", ",", 
      "k_"}], "]"}], ":=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"jacSurfExpand", "[", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{
          RowBox[{"symmetrizeQ", "[", 
           RowBox[{"surfBeris", "[", 
            RowBox[{"m", ",", "n"}], "]"}], "]"}], "/.", "preRules"}], "]"}], 
        "]"}], ",", 
       RowBox[{"Q", "[", 
        RowBox[{"mm", ",", "nn", ",", "i", ",", "j", ",", "k"}], "]"}]}], 
      "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"surfJactoCode", "[", 
     RowBox[{
     "m_", ",", "n_", ",", "mm_", ",", "nn_", ",", "ii_", ",", "jj_", ",", 
      "kk_"}], "]"}], ":=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<gsl_matrix_set(mm,\>\"", ",", 
      RowBox[{"postionCreator", "[", 
       RowBox[{"m", ",", "n", ",", "i", ",", "j", ",", "k"}], "]"}], ",", 
      "\"\<,\>\"", ",", 
      RowBox[{"postionCreator", "[", 
       RowBox[{"mm", ",", "nn", ",", "ii", ",", "jj", ",", "kk"}], "]"}], 
      ",", "\"\<,\>\"", ",", "\"\<Lambda*(\>\"", ",", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"CForm", "[", 
          RowBox[{"surfJacobian", "[", 
           RowBox[{
           "m", ",", "n", ",", "mm", ",", "nn", ",", "ii", ",", "jj", ",", 
            "kk"}], "]"}], "]"}], "]"}], ",", "jacRules"}], "]"}], ",", 
      "\"\<));\\n\\n\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", 
    RowBox[{
    "i", ",", "j", ",", "k", ",", "ip1", ",", "im1", ",", "jp1", ",", "jm1", 
     ",", "kp1", ",", "km1"}], "]"}], ";", "\[IndentingNewLine]", 
   RowBox[{"is", "=", 
    RowBox[{"{", 
     RowBox[{"ip1", ",", "i", ",", "im1"}], "}"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"js", "=", 
    RowBox[{"{", 
     RowBox[{"jp1", ",", "j", ",", "jm1"}], "}"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"ks", "=", 
    RowBox[{"{", 
     RowBox[{"kp1", ",", "k", ",", "km1"}], "}"}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"ii", "=", "0"}], ",", 
     RowBox[{"ii", "\[LessEqual]", "2"}], ",", 
     RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"jj", "=", "0"}], ",", 
       RowBox[{"jj", "\[LessEqual]", "2"}], ",", 
       RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"kk", "=", "0"}], ",", 
         RowBox[{"kk", "\[LessEqual]", "2"}], ",", 
         RowBox[{"kk", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"ll", "=", "0"}], ",", 
           RowBox[{"ll", "\[LessEqual]", "2"}], ",", 
           RowBox[{"ll", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"il", "=", "0"}], ",", 
             RowBox[{"il", "\[LessEqual]", "2"}], ",", 
             RowBox[{
              RowBox[{"il", "++"}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"jl", "=", "0"}], ",", 
                RowBox[{"jl", "\[LessEqual]", "2"}], ",", 
                RowBox[{
                 RowBox[{"jl", "++"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"kl", "=", "0"}], ",", 
                   RowBox[{"kl", "\[LessEqual]", "2"}], ",", 
                   RowBox[{
                    RowBox[{"kl", "++"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"code", "=", 
                    RowBox[{"surfJactoCode", "[", 
                    RowBox[{"ii", ",", "jj", ",", "kk", ",", "ll", ",", 
                    RowBox[{"is", "[", 
                    RowBox[{"[", "il", "]"}], "]"}], ",", 
                    RowBox[{"js", "[", 
                    RowBox[{"[", "jl", "]"}], "]"}], ",", 
                    RowBox[{"ks", "[", 
                    RowBox[{"[", "kl", "]"}], "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{"code", ",", "\"\<*None*\>\""}], "]"}]}], " ", "&&",
                     " ", 
                    RowBox[{"!", " ", 
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{"code", ",", "\"\<*0));\\n\\n\>\""}], "]"}]}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"code", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "RegularExpression", "[", 
                    "\"\<Q\\\\((.),(.),(.),(.),(.)\\\\)\>\"", "]"}], 
                    "\[Rule]", "\"\<QQ_$1$2($3,$4,$5)\>\""}], ",", 
                    RowBox[{"\"\<l1\>\"", "\[Rule]", "\"\<L1_tilde\>\""}]}], 
                    "}"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
                  "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.712399910906857*^9, 3.712399977145175*^9}, {
  3.712400832327179*^9, 3.712400833460176*^9}, {3.712401227475155*^9, 
  3.71240123851937*^9}, {3.7142099964689207`*^9, 3.714210008828478*^9}}],

Cell[CellGroupData[{

Cell[BoxData["String"], "Input",
 CellChangeTimes->{{3.777978157400783*^9, 3.777978158560709*^9}}],

Cell[BoxData["String"], "Output",
 CellChangeTimes->{3.7779781592272787`*^9, 3.777989603844913*^9, 
  3.7779896712569447`*^9, 3.7779897234764957`*^9, 3.777990854986012*^9, 
  3.777995627120479*^9, 3.7779958215236464`*^9, 3.7779962725091963`*^9, 
  3.778000685809619*^9, 3.7782308984851303`*^9, 3.778231804997213*^9, 
  3.778246070967626*^9, 3.778246331445853*^9, 3.778246601010734*^9, 
  3.7782495574539623`*^9, 3.778249746550967*^9, 3.778249908447567*^9, 
  3.77825046240696*^9, 3.778254007579563*^9, 3.778254578636138*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "JacobianString", "]"}]], "Input",
 CellChangeTimes->{{3.778246725811153*^9, 3.778246739509692*^9}}],

Cell[BoxData["87"], "Output",
 CellChangeTimes->{3.778246740145162*^9, 3.778249557713661*^9, 
  3.778249746778474*^9, 3.778249908696554*^9, 3.778250462457443*^9, 
  3.7782540079007053`*^9, 3.778254578646961*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1366, 704},
WindowMargins->{{-1, Automatic}, {Automatic, -1}},
FrontEndVersion->"10.0 for Linux x86 (64-bit) (June 27, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 176, 2, 96, "Title"],
Cell[CellGroupData[{
Cell[781, 28, 157, 2, 67, "Section"],
Cell[CellGroupData[{
Cell[963, 34, 106, 1, 47, "Subsection"],
Cell[1072, 37, 424, 7, 55, "Text"],
Cell[1499, 46, 9687, 271, 671, "Input"],
Cell[11189, 319, 10705, 251, 637, "Input"],
Cell[21897, 572, 2556, 75, 77, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24490, 652, 159, 2, 47, "Subsection"],
Cell[24652, 656, 413, 13, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25102, 674, 147, 2, 47, "Subsection"],
Cell[25252, 678, 7197, 186, 410, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32486, 869, 104, 1, 47, "Subsection"],
Cell[CellGroupData[{
Cell[32615, 874, 111, 1, 37, "Subsubsection"],
Cell[32729, 877, 686, 16, 62, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33452, 898, 103, 1, 37, "Subsubsection"],
Cell[33558, 901, 637, 17, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34232, 923, 158, 2, 37, "Subsubsection"],
Cell[34393, 927, 170, 2, 33, "Text"],
Cell[34566, 931, 116, 1, 33, "Text"],
Cell[34685, 934, 5161, 130, 344, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[39907, 1071, 100, 1, 69, "Chapter"],
Cell[CellGroupData[{
Cell[40032, 1076, 107, 1, 67, "Section"],
Cell[40142, 1079, 721, 11, 32, "Input"],
Cell[CellGroupData[{
Cell[40888, 1094, 139, 1, 47, "Subsection"],
Cell[41030, 1097, 6074, 128, 275, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[47153, 1231, 155, 2, 67, "Section"],
Cell[47311, 1235, 296, 5, 33, "Text"],
Cell[47610, 1242, 2095, 39, 77, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49742, 1286, 149, 2, 67, "Section"],
Cell[CellGroupData[{
Cell[49916, 1292, 103, 1, 47, "Subsection"],
Cell[50022, 1295, 2901, 62, 77, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52960, 1362, 108, 1, 47, "Subsection"],
Cell[53071, 1365, 2967, 83, 121, "Input"],
Cell[CellGroupData[{
Cell[56063, 1452, 130, 1, 37, "Subsubsection"],
Cell[56196, 1455, 129, 1, 33, "Text"],
Cell[56328, 1458, 7800, 147, 539, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64165, 1610, 188, 2, 37, "Subsubsection"],
Cell[CellGroupData[{
Cell[64378, 1616, 1821, 43, 143, "Input"],
Cell[66202, 1661, 2373, 33, 693, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[68636, 1701, 99, 1, 47, "Subsection"],
Cell[CellGroupData[{
Cell[68760, 1706, 1529, 38, 121, "Input"],
Cell[70292, 1746, 4268, 60, 957, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74597, 1811, 97, 1, 37, "Subsubsection"],
Cell[CellGroupData[{
Cell[74719, 1816, 1697, 42, 143, "Input"],
Cell[76419, 1860, 3950, 55, 737, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[80454, 1924, 113, 1, 69, "Chapter"],
Cell[CellGroupData[{
Cell[80592, 1929, 106, 1, 67, "Section"],
Cell[80701, 1932, 4419, 108, 407, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85157, 2045, 92, 1, 67, "Section"],
Cell[85252, 2048, 2137, 46, 121, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87426, 2099, 91, 1, 67, "Section"],
Cell[87520, 2102, 339, 5, 32, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[87908, 2113, 95, 1, 69, "Chapter"],
Cell[CellGroupData[{
Cell[88028, 2118, 104, 1, 67, "Section"],
Cell[88135, 2121, 1236, 25, 99, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89408, 2151, 91, 1, 67, "Section"],
Cell[89502, 2154, 19526, 427, 1353, "Input"],
Cell[CellGroupData[{
Cell[109053, 2585, 193, 3, 32, "Input"],
Cell[109249, 2590, 18603, 255, 9933, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[127901, 2851, 94, 1, 67, "Section"],
Cell[127998, 2854, 8229, 195, 803, "Input"],
Cell[CellGroupData[{
Cell[136252, 3053, 98, 1, 32, "Input"],
Cell[136353, 3056, 524, 7, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[136914, 3068, 138, 2, 32, "Input"],
Cell[137055, 3072, 211, 3, 65, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
